`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 05-19 08:20:34 llm_engine.py:87] Initializing an LLM engine with config: model='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 05-19 08:20:43 llm_engine.py:357] # GPU blocks: 27829, # CPU blocks: 2048
Time to load model: 14.90 seconds
Iteration:   0%|          | 0/2416 [00:00<?, ?it/s]Iteration:  38%|███▊      | 907/2416 [00:01<00:01, 770.56it/s]Iteration:  38%|███▊      | 907/2416 [00:19<00:01, 770.56it/s]Iteration:  38%|███▊      | 923/2416 [00:21<00:48, 30.53it/s] Iteration:  38%|███▊      | 924/2416 [00:22<00:53, 28.12it/s]Iteration:  38%|███▊      | 924/2416 [00:39<00:53, 28.12it/s]Iteration:  39%|███▉      | 938/2416 [00:40<02:07, 11.55it/s]Iteration:  39%|███▉      | 939/2416 [00:41<02:15, 10.90it/s]Iteration:  39%|███▉      | 939/2416 [00:59<02:15, 10.90it/s]Iteration:  39%|███▉      | 953/2416 [01:00<04:38,  5.25it/s]Iteration:  39%|███▉      | 954/2416 [01:01<04:50,  5.03it/s]Iteration:  40%|███▉      | 965/2416 [01:16<07:43,  3.13it/s]Iteration:  40%|███▉      | 966/2416 [01:17<08:01,  3.01it/s]Iteration:  40%|████      | 973/2416 [01:25<10:42,  2.25it/s]Iteration:  40%|████      | 978/2416 [01:32<13:10,  1.82it/s]Iteration:  41%|████      | 982/2416 [01:38<15:35,  1.53it/s]Iteration:  41%|████      | 985/2416 [01:42<17:28,  1.36it/s]Iteration:  41%|████      | 987/2416 [01:45<18:21,  1.30it/s]Iteration:  41%|████      | 989/2416 [01:47<19:44,  1.20it/s]Iteration:  41%|████      | 990/2416 [01:48<20:19,  1.17it/s]Iteration:  41%|████      | 991/2416 [01:50<21:44,  1.09it/s]Iteration:  41%|████      | 992/2416 [01:52<25:04,  1.06s/it]Iteration:  41%|████      | 993/2416 [01:53<25:30,  1.08s/it]Iteration:  41%|████      | 994/2416 [01:54<25:37,  1.08s/it]Iteration:  41%|████      | 995/2416 [01:55<25:38,  1.08s/it]Iteration:  41%|████      | 996/2416 [01:57<27:46,  1.17s/it]Iteration:  41%|████▏     | 997/2416 [01:58<28:40,  1.21s/it]Iteration:  41%|████▏     | 998/2416 [01:59<28:23,  1.20s/it]Iteration:  41%|████▏     | 999/2416 [02:00<29:10,  1.24s/it]Iteration:  41%|████▏     | 1000/2416 [02:02<29:13,  1.24s/it]Iteration:  41%|████▏     | 1001/2416 [02:03<29:23,  1.25s/it]Iteration:  41%|████▏     | 1002/2416 [02:05<32:18,  1.37s/it]Iteration:  42%|████▏     | 1003/2416 [02:06<31:18,  1.33s/it]Iteration:  42%|████▏     | 1004/2416 [02:07<33:05,  1.41s/it]Iteration:  42%|████▏     | 1005/2416 [02:09<34:04,  1.45s/it]Iteration:  42%|████▏     | 1006/2416 [02:10<32:11,  1.37s/it]Iteration:  42%|████▏     | 1007/2416 [02:12<33:39,  1.43s/it]Iteration:  42%|████▏     | 1008/2416 [02:13<32:29,  1.38s/it]Iteration:  42%|████▏     | 1009/2416 [02:15<33:43,  1.44s/it]Iteration:  42%|████▏     | 1010/2416 [02:16<33:08,  1.41s/it]Iteration:  42%|████▏     | 1011/2416 [02:17<32:29,  1.39s/it]Iteration:  42%|████▏     | 1012/2416 [02:18<29:35,  1.26s/it]Iteration:  42%|████▏     | 1013/2416 [02:20<31:06,  1.33s/it]Iteration:  42%|████▏     | 1014/2416 [02:21<31:09,  1.33s/it]Iteration:  42%|████▏     | 1015/2416 [02:22<30:43,  1.32s/it]Iteration:  42%|████▏     | 1016/2416 [02:24<30:10,  1.29s/it]Iteration:  42%|████▏     | 1017/2416 [02:25<28:35,  1.23s/it]Iteration:  42%|████▏     | 1018/2416 [02:26<28:43,  1.23s/it]Iteration:  42%|████▏     | 1019/2416 [02:27<28:15,  1.21s/it]Iteration:  42%|████▏     | 1020/2416 [02:29<30:14,  1.30s/it]Iteration:  42%|████▏     | 1021/2416 [02:31<40:09,  1.73s/it]Iteration:  42%|████▏     | 1022/2416 [02:33<36:29,  1.57s/it]Iteration:  42%|████▏     | 1023/2416 [02:34<35:13,  1.52s/it]Iteration:  42%|████▏     | 1024/2416 [02:35<32:29,  1.40s/it]Iteration:  42%|████▏     | 1025/2416 [02:36<32:16,  1.39s/it]Iteration:  42%|████▏     | 1026/2416 [02:38<33:22,  1.44s/it]Iteration:  43%|████▎     | 1027/2416 [02:40<34:38,  1.50s/it]Iteration:  43%|████▎     | 1028/2416 [02:41<32:19,  1.40s/it]Iteration:  43%|████▎     | 1029/2416 [02:42<32:47,  1.42s/it]Iteration:  43%|████▎     | 1030/2416 [02:43<30:55,  1.34s/it]Iteration:  43%|████▎     | 1031/2416 [02:45<29:37,  1.28s/it]Iteration:  43%|████▎     | 1032/2416 [02:46<28:58,  1.26s/it]Iteration:  43%|████▎     | 1033/2416 [02:47<29:21,  1.27s/it]Iteration:  43%|████▎     | 1034/2416 [02:48<27:57,  1.21s/it]Iteration:  43%|████▎     | 1035/2416 [02:49<28:20,  1.23s/it]Iteration:  43%|████▎     | 1036/2416 [02:51<28:57,  1.26s/it]Iteration:  43%|████▎     | 1037/2416 [02:52<29:45,  1.29s/it]Iteration:  43%|████▎     | 1038/2416 [02:53<29:35,  1.29s/it]Iteration:  43%|████▎     | 1039/2416 [02:54<28:20,  1.24s/it]Iteration:  43%|████▎     | 1040/2416 [02:55<26:52,  1.17s/it]Iteration:  43%|████▎     | 1041/2416 [02:57<28:32,  1.25s/it]Iteration:  43%|████▎     | 1042/2416 [02:58<26:52,  1.17s/it]Iteration:  43%|████▎     | 1043/2416 [02:59<29:16,  1.28s/it]Iteration:  43%|████▎     | 1044/2416 [03:01<28:35,  1.25s/it]Iteration:  43%|████▎     | 1045/2416 [03:02<29:40,  1.30s/it]Iteration:  43%|████▎     | 1046/2416 [03:03<28:57,  1.27s/it]Iteration:  43%|████▎     | 1047/2416 [03:04<28:48,  1.26s/it]Iteration:  43%|████▎     | 1048/2416 [03:05<26:19,  1.15s/it]Iteration:  43%|████▎     | 1049/2416 [03:07<27:32,  1.21s/it]Iteration:  43%|████▎     | 1050/2416 [03:08<27:20,  1.20s/it]Iteration:  44%|████▎     | 1051/2416 [03:09<27:37,  1.21s/it]Iteration:  44%|████▎     | 1052/2416 [03:10<26:18,  1.16s/it]Iteration:  44%|████▎     | 1053/2416 [03:12<27:42,  1.22s/it]Iteration:  44%|████▎     | 1054/2416 [03:13<28:16,  1.25s/it]Iteration:  44%|████▎     | 1055/2416 [03:14<29:40,  1.31s/it]Iteration:  44%|████▎     | 1056/2416 [03:16<32:36,  1.44s/it]Iteration:  44%|████▍     | 1057/2416 [03:17<31:33,  1.39s/it]Iteration:  44%|████▍     | 1058/2416 [03:18<29:30,  1.30s/it]Iteration:  44%|████▍     | 1059/2416 [03:20<29:05,  1.29s/it]Iteration:  44%|████▍     | 1060/2416 [03:21<28:47,  1.27s/it]Iteration:  44%|████▍     | 1061/2416 [03:23<31:09,  1.38s/it]Iteration:  44%|████▍     | 1062/2416 [03:24<32:50,  1.46s/it]Iteration:  44%|████▍     | 1063/2416 [03:26<33:14,  1.47s/it]Iteration:  44%|████▍     | 1064/2416 [03:27<33:37,  1.49s/it]Iteration:  44%|████▍     | 1065/2416 [03:29<33:47,  1.50s/it]Iteration:  44%|████▍     | 1066/2416 [03:30<33:28,  1.49s/it]Iteration:  44%|████▍     | 1067/2416 [03:32<32:25,  1.44s/it]Iteration:  44%|████▍     | 1068/2416 [03:33<34:17,  1.53s/it]Iteration:  44%|████▍     | 1069/2416 [03:35<32:28,  1.45s/it]Iteration:  44%|████▍     | 1070/2416 [03:36<32:03,  1.43s/it]Iteration:  44%|████▍     | 1071/2416 [03:37<30:09,  1.35s/it]Iteration:  44%|████▍     | 1072/2416 [03:38<28:51,  1.29s/it]Iteration:  44%|████▍     | 1073/2416 [03:39<27:55,  1.25s/it]Iteration:  44%|████▍     | 1074/2416 [03:41<27:34,  1.23s/it]Iteration:  44%|████▍     | 1075/2416 [03:42<27:34,  1.23s/it]Iteration:  45%|████▍     | 1076/2416 [03:43<27:02,  1.21s/it]Iteration:  45%|████▍     | 1077/2416 [03:44<27:47,  1.25s/it]Iteration:  45%|████▍     | 1078/2416 [03:46<31:08,  1.40s/it]Iteration:  45%|████▍     | 1079/2416 [03:47<29:42,  1.33s/it]Iteration:  45%|████▍     | 1080/2416 [03:49<30:59,  1.39s/it]Iteration:  45%|████▍     | 1081/2416 [03:50<28:55,  1.30s/it]Iteration:  45%|████▍     | 1082/2416 [03:51<28:33,  1.28s/it]Iteration:  45%|████▍     | 1083/2416 [03:52<27:20,  1.23s/it]Iteration:  45%|████▍     | 1084/2416 [03:54<28:39,  1.29s/it]Iteration:  45%|████▍     | 1085/2416 [03:55<28:53,  1.30s/it]Iteration:  45%|████▍     | 1086/2416 [03:57<32:18,  1.46s/it]Iteration:  45%|████▍     | 1087/2416 [03:58<31:35,  1.43s/it]Iteration:  45%|████▌     | 1088/2416 [04:00<34:35,  1.56s/it]Iteration:  45%|████▌     | 1089/2416 [04:01<31:07,  1.41s/it]Iteration:  45%|████▌     | 1090/2416 [04:02<30:58,  1.40s/it]Iteration:  45%|████▌     | 1091/2416 [04:04<29:54,  1.35s/it]Iteration:  45%|████▌     | 1092/2416 [04:05<30:04,  1.36s/it]Iteration:  45%|████▌     | 1093/2416 [04:06<28:31,  1.29s/it]Iteration:  45%|████▌     | 1094/2416 [04:08<29:33,  1.34s/it]Iteration:  45%|████▌     | 1095/2416 [04:09<30:45,  1.40s/it]Iteration:  45%|████▌     | 1096/2416 [04:10<30:12,  1.37s/it]Iteration:  45%|████▌     | 1097/2416 [04:12<29:02,  1.32s/it]Iteration:  45%|████▌     | 1098/2416 [04:13<32:02,  1.46s/it]Iteration:  45%|████▌     | 1099/2416 [04:16<39:11,  1.79s/it]Iteration:  46%|████▌     | 1100/2416 [04:17<35:53,  1.64s/it]Iteration:  46%|████▌     | 1101/2416 [04:19<33:16,  1.52s/it]Iteration:  46%|████▌     | 1102/2416 [04:20<34:07,  1.56s/it]Iteration:  46%|████▌     | 1103/2416 [04:22<34:01,  1.56s/it]Iteration:  46%|████▌     | 1104/2416 [04:23<29:48,  1.36s/it]Iteration:  46%|████▌     | 1105/2416 [04:24<28:07,  1.29s/it]Iteration:  46%|████▌     | 1106/2416 [04:25<27:15,  1.25s/it]Iteration:  46%|████▌     | 1107/2416 [04:27<29:36,  1.36s/it]Iteration:  46%|████▌     | 1108/2416 [04:28<28:56,  1.33s/it]Iteration:  46%|████▌     | 1109/2416 [04:29<28:04,  1.29s/it]Iteration:  46%|████▌     | 1110/2416 [04:30<28:05,  1.29s/it]Iteration:  46%|████▌     | 1111/2416 [04:32<28:14,  1.30s/it]Iteration:  46%|████▌     | 1112/2416 [04:33<31:14,  1.44s/it]Iteration:  46%|████▌     | 1113/2416 [04:35<34:06,  1.57s/it]Iteration:  46%|████▌     | 1114/2416 [04:36<29:55,  1.38s/it]Iteration:  46%|████▌     | 1115/2416 [04:37<29:17,  1.35s/it]Iteration:  46%|████▌     | 1116/2416 [04:39<28:11,  1.30s/it]Iteration:  46%|████▌     | 1117/2416 [04:40<27:02,  1.25s/it]Iteration:  46%|████▋     | 1118/2416 [04:41<28:29,  1.32s/it]Iteration:  46%|████▋     | 1119/2416 [04:42<27:27,  1.27s/it]Iteration:  46%|████▋     | 1120/2416 [04:44<27:57,  1.29s/it]Iteration:  46%|████▋     | 1121/2416 [04:45<29:17,  1.36s/it]Iteration:  46%|████▋     | 1122/2416 [04:47<29:09,  1.35s/it]Iteration:  46%|████▋     | 1123/2416 [04:48<29:02,  1.35s/it]Iteration:  47%|████▋     | 1124/2416 [04:49<27:29,  1.28s/it]Iteration:  47%|████▋     | 1125/2416 [04:51<31:03,  1.44s/it]Iteration:  47%|████▋     | 1126/2416 [04:52<31:15,  1.45s/it]Iteration:  47%|████▋     | 1127/2416 [04:54<29:43,  1.38s/it]Iteration:  47%|████▋     | 1128/2416 [04:55<28:22,  1.32s/it]Iteration:  47%|████▋     | 1129/2416 [04:56<26:38,  1.24s/it]Iteration:  47%|████▋     | 1130/2416 [04:57<24:46,  1.16s/it]Iteration:  47%|████▋     | 1131/2416 [04:59<28:36,  1.34s/it]Iteration:  47%|████▋     | 1132/2416 [05:00<30:43,  1.44s/it]Iteration:  47%|████▋     | 1133/2416 [05:01<29:13,  1.37s/it]Iteration:  47%|████▋     | 1134/2416 [05:03<29:04,  1.36s/it]Iteration:  47%|████▋     | 1135/2416 [05:04<29:56,  1.40s/it]Iteration:  47%|████▋     | 1136/2416 [05:05<27:32,  1.29s/it]Iteration:  47%|████▋     | 1137/2416 [05:07<29:27,  1.38s/it]Iteration:  47%|████▋     | 1138/2416 [05:09<31:35,  1.48s/it]Iteration:  47%|████▋     | 1139/2416 [05:10<31:26,  1.48s/it]Iteration:  47%|████▋     | 1140/2416 [05:12<32:11,  1.51s/it]Iteration:  47%|████▋     | 1141/2416 [05:13<31:23,  1.48s/it]Iteration:  47%|████▋     | 1142/2416 [05:14<30:08,  1.42s/it]Iteration:  47%|████▋     | 1143/2416 [05:16<31:34,  1.49s/it]Iteration:  47%|████▋     | 1144/2416 [05:17<31:40,  1.49s/it]Iteration:  47%|████▋     | 1145/2416 [05:19<30:18,  1.43s/it]Iteration:  47%|████▋     | 1146/2416 [05:20<30:50,  1.46s/it]Iteration:  47%|████▋     | 1147/2416 [05:22<29:57,  1.42s/it]Iteration:  48%|████▊     | 1148/2416 [05:23<29:31,  1.40s/it]Iteration:  48%|████▊     | 1149/2416 [05:24<28:21,  1.34s/it]Iteration:  48%|████▊     | 1150/2416 [05:26<30:37,  1.45s/it]Iteration:  48%|████▊     | 1151/2416 [05:27<29:58,  1.42s/it]Iteration:  48%|████▊     | 1152/2416 [05:29<30:20,  1.44s/it]Iteration:  48%|████▊     | 1153/2416 [05:30<29:17,  1.39s/it]Iteration:  48%|████▊     | 1154/2416 [05:31<29:36,  1.41s/it]Iteration:  48%|████▊     | 1155/2416 [05:33<28:40,  1.36s/it]Iteration:  48%|████▊     | 1156/2416 [05:34<30:25,  1.45s/it]Iteration:  48%|████▊     | 1157/2416 [05:36<30:02,  1.43s/it]Iteration:  48%|████▊     | 1158/2416 [05:37<29:57,  1.43s/it]Iteration:  48%|████▊     | 1159/2416 [05:38<27:47,  1.33s/it]Iteration:  48%|████▊     | 1160/2416 [05:40<28:04,  1.34s/it]Iteration:  48%|████▊     | 1161/2416 [05:41<28:08,  1.35s/it]Iteration:  48%|████▊     | 1162/2416 [05:43<30:04,  1.44s/it]Iteration:  48%|████▊     | 1163/2416 [05:44<28:28,  1.36s/it]Iteration:  48%|████▊     | 1164/2416 [05:45<28:27,  1.36s/it]Iteration:  48%|████▊     | 1165/2416 [05:46<27:12,  1.31s/it]Iteration:  48%|████▊     | 1166/2416 [05:48<28:17,  1.36s/it]Iteration:  48%|████▊     | 1167/2416 [05:49<28:05,  1.35s/it]Iteration:  48%|████▊     | 1168/2416 [05:50<27:20,  1.31s/it]Iteration:  48%|████▊     | 1169/2416 [05:52<27:17,  1.31s/it]Iteration:  48%|████▊     | 1170/2416 [05:53<28:05,  1.35s/it]Iteration:  48%|████▊     | 1171/2416 [05:55<28:12,  1.36s/it]Iteration:  49%|████▊     | 1172/2416 [05:56<27:38,  1.33s/it]Iteration:  49%|████▊     | 1173/2416 [05:57<25:26,  1.23s/it]Iteration:  49%|████▊     | 1174/2416 [05:58<26:05,  1.26s/it]Iteration:  49%|████▊     | 1175/2416 [05:59<25:14,  1.22s/it]Iteration:  49%|████▊     | 1176/2416 [06:01<25:27,  1.23s/it]Iteration:  49%|████▊     | 1177/2416 [06:02<26:29,  1.28s/it]Iteration:  49%|████▉     | 1178/2416 [06:03<26:09,  1.27s/it]Iteration:  49%|████▉     | 1179/2416 [06:04<24:41,  1.20s/it]Iteration:  49%|████▉     | 1180/2416 [06:05<25:11,  1.22s/it]Iteration:  49%|████▉     | 1181/2416 [06:07<24:24,  1.19s/it]Iteration:  49%|████▉     | 1182/2416 [06:08<24:17,  1.18s/it]Iteration:  49%|████▉     | 1183/2416 [06:09<24:38,  1.20s/it]Iteration:  49%|████▉     | 1184/2416 [06:11<26:42,  1.30s/it]Iteration:  49%|████▉     | 1185/2416 [06:12<28:20,  1.38s/it]Iteration:  49%|████▉     | 1186/2416 [06:14<28:53,  1.41s/it]Iteration:  49%|████▉     | 1187/2416 [06:15<29:59,  1.46s/it]Iteration:  49%|████▉     | 1188/2416 [06:16<27:07,  1.33s/it]Iteration:  49%|████▉     | 1189/2416 [06:17<26:50,  1.31s/it]Iteration:  49%|████▉     | 1190/2416 [06:19<26:36,  1.30s/it]Iteration:  49%|████▉     | 1191/2416 [06:20<25:53,  1.27s/it]Iteration:  49%|████▉     | 1192/2416 [06:21<26:57,  1.32s/it]Iteration:  49%|████▉     | 1193/2416 [06:23<26:05,  1.28s/it]Iteration:  49%|████▉     | 1194/2416 [06:24<26:57,  1.32s/it]Iteration:  49%|████▉     | 1195/2416 [06:25<25:16,  1.24s/it]Iteration:  50%|████▉     | 1196/2416 [06:26<24:16,  1.19s/it]Iteration:  50%|████▉     | 1197/2416 [06:27<24:19,  1.20s/it]Iteration:  50%|████▉     | 1198/2416 [06:28<23:31,  1.16s/it]Iteration:  50%|████▉     | 1199/2416 [06:30<26:24,  1.30s/it]Iteration:  50%|████▉     | 1200/2416 [06:31<27:18,  1.35s/it]Iteration:  50%|████▉     | 1201/2416 [06:32<25:20,  1.25s/it]Iteration:  50%|████▉     | 1202/2416 [06:34<25:12,  1.25s/it]Iteration:  50%|████▉     | 1203/2416 [06:35<23:01,  1.14s/it]Iteration:  50%|████▉     | 1204/2416 [06:36<24:43,  1.22s/it]Iteration:  50%|████▉     | 1205/2416 [06:38<26:50,  1.33s/it]Iteration:  50%|████▉     | 1206/2416 [06:39<26:57,  1.34s/it]Iteration:  50%|████▉     | 1207/2416 [06:40<26:08,  1.30s/it]Iteration:  50%|█████     | 1208/2416 [06:41<24:41,  1.23s/it]Iteration:  50%|█████     | 1208/2416 [06:41<06:41,  3.01it/s]
