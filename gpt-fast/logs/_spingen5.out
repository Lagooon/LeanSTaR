`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 05-19 08:20:35 llm_engine.py:87] Initializing an LLM engine with config: model='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 05-19 08:20:43 llm_engine.py:357] # GPU blocks: 27829, # CPU blocks: 2048
Time to load model: 14.49 seconds
Iteration:   0%|          | 0/2416 [00:00<?, ?it/s]Iteration:  63%|██████▎   | 1511/2416 [00:01<00:00, 1288.14it/s]Iteration:  63%|██████▎   | 1511/2416 [00:19<00:00, 1288.14it/s]Iteration:  63%|██████▎   | 1525/2416 [00:20<00:16, 52.81it/s]  Iteration:  63%|██████▎   | 1526/2416 [00:22<00:18, 48.28it/s]Iteration:  63%|██████▎   | 1526/2416 [00:39<00:18, 48.28it/s]Iteration:  64%|██████▎   | 1539/2416 [00:40<00:48, 18.14it/s]Iteration:  64%|██████▎   | 1540/2416 [00:41<00:50, 17.28it/s]Iteration:  64%|██████▎   | 1540/2416 [00:59<00:50, 17.28it/s]Iteration:  64%|██████▍   | 1555/2416 [01:01<01:46,  8.09it/s]Iteration:  64%|██████▍   | 1556/2416 [01:02<01:50,  7.75it/s]Iteration:  64%|██████▍   | 1556/2416 [01:19<01:50,  7.75it/s]Iteration:  65%|██████▍   | 1569/2416 [01:19<03:18,  4.26it/s]Iteration:  65%|██████▍   | 1570/2416 [01:21<03:30,  4.01it/s]Iteration:  65%|██████▌   | 1582/2416 [01:37<05:26,  2.56it/s]Iteration:  66%|██████▌   | 1583/2416 [01:38<05:41,  2.44it/s]Iteration:  66%|██████▌   | 1591/2416 [01:49<07:47,  1.76it/s]Iteration:  66%|██████▌   | 1592/2416 [01:51<08:05,  1.70it/s]Iteration:  66%|██████▌   | 1598/2416 [01:59<10:04,  1.35it/s]Iteration:  66%|██████▋   | 1602/2416 [02:05<11:26,  1.18it/s]Iteration:  66%|██████▋   | 1605/2416 [02:09<12:34,  1.07it/s]Iteration:  67%|██████▋   | 1607/2416 [02:11<12:55,  1.04it/s]Iteration:  67%|██████▋   | 1609/2416 [02:15<13:59,  1.04s/it]Iteration:  67%|██████▋   | 1610/2416 [02:16<14:26,  1.08s/it]Iteration:  67%|██████▋   | 1611/2416 [02:17<14:19,  1.07s/it]Iteration:  67%|██████▋   | 1612/2416 [02:18<14:22,  1.07s/it]Iteration:  67%|██████▋   | 1613/2416 [02:19<14:09,  1.06s/it]Iteration:  67%|██████▋   | 1614/2416 [02:20<14:34,  1.09s/it]Iteration:  67%|██████▋   | 1615/2416 [02:22<15:26,  1.16s/it]Iteration:  67%|██████▋   | 1616/2416 [02:23<15:42,  1.18s/it]Iteration:  67%|██████▋   | 1617/2416 [02:24<15:08,  1.14s/it]Iteration:  67%|██████▋   | 1618/2416 [02:25<15:34,  1.17s/it]Iteration:  67%|██████▋   | 1619/2416 [02:27<16:28,  1.24s/it]Iteration:  67%|██████▋   | 1620/2416 [02:28<15:26,  1.16s/it]Iteration:  67%|██████▋   | 1621/2416 [02:29<17:26,  1.32s/it]Iteration:  67%|██████▋   | 1622/2416 [02:31<17:13,  1.30s/it]Iteration:  67%|██████▋   | 1623/2416 [02:32<16:36,  1.26s/it]Iteration:  67%|██████▋   | 1624/2416 [02:33<16:16,  1.23s/it]Iteration:  67%|██████▋   | 1625/2416 [02:34<15:43,  1.19s/it]Iteration:  67%|██████▋   | 1626/2416 [02:36<17:36,  1.34s/it]Iteration:  67%|██████▋   | 1627/2416 [02:37<17:49,  1.36s/it]Iteration:  67%|██████▋   | 1628/2416 [02:38<17:32,  1.34s/it]Iteration:  67%|██████▋   | 1629/2416 [02:39<16:29,  1.26s/it]Iteration:  67%|██████▋   | 1630/2416 [02:41<19:41,  1.50s/it]Iteration:  68%|██████▊   | 1631/2416 [02:43<18:32,  1.42s/it]Iteration:  68%|██████▊   | 1632/2416 [02:44<18:19,  1.40s/it]Iteration:  68%|██████▊   | 1633/2416 [02:46<19:07,  1.47s/it]Iteration:  68%|██████▊   | 1634/2416 [02:47<18:13,  1.40s/it]Iteration:  68%|██████▊   | 1635/2416 [02:48<17:33,  1.35s/it]Iteration:  68%|██████▊   | 1636/2416 [02:49<17:31,  1.35s/it]Iteration:  68%|██████▊   | 1637/2416 [02:51<16:44,  1.29s/it]Iteration:  68%|██████▊   | 1638/2416 [02:52<16:29,  1.27s/it]Iteration:  68%|██████▊   | 1639/2416 [02:54<17:53,  1.38s/it]Iteration:  68%|██████▊   | 1640/2416 [02:55<19:48,  1.53s/it]Iteration:  68%|██████▊   | 1641/2416 [02:57<20:04,  1.55s/it]Iteration:  68%|██████▊   | 1642/2416 [02:58<18:05,  1.40s/it]Iteration:  68%|██████▊   | 1643/2416 [02:59<17:08,  1.33s/it]Iteration:  68%|██████▊   | 1644/2416 [03:01<17:06,  1.33s/it]Iteration:  68%|██████▊   | 1645/2416 [03:02<16:31,  1.29s/it]Iteration:  68%|██████▊   | 1646/2416 [03:03<15:59,  1.25s/it]Iteration:  68%|██████▊   | 1647/2416 [03:04<15:53,  1.24s/it]Iteration:  68%|██████▊   | 1648/2416 [03:05<16:19,  1.28s/it]Iteration:  68%|██████▊   | 1649/2416 [03:06<15:14,  1.19s/it]Iteration:  68%|██████▊   | 1650/2416 [03:08<15:33,  1.22s/it]Iteration:  68%|██████▊   | 1651/2416 [03:09<16:10,  1.27s/it]Iteration:  68%|██████▊   | 1652/2416 [03:10<16:17,  1.28s/it]Iteration:  68%|██████▊   | 1653/2416 [03:12<17:12,  1.35s/it]Iteration:  68%|██████▊   | 1654/2416 [03:13<17:07,  1.35s/it]Iteration:  69%|██████▊   | 1655/2416 [03:14<16:20,  1.29s/it]Iteration:  69%|██████▊   | 1656/2416 [03:16<16:53,  1.33s/it]Iteration:  69%|██████▊   | 1657/2416 [03:17<16:53,  1.34s/it]Iteration:  69%|██████▊   | 1658/2416 [03:18<15:41,  1.24s/it]Iteration:  69%|██████▊   | 1659/2416 [03:20<16:26,  1.30s/it]Iteration:  69%|██████▊   | 1660/2416 [03:21<15:22,  1.22s/it]Iteration:  69%|██████▉   | 1661/2416 [03:22<15:01,  1.19s/it]Iteration:  69%|██████▉   | 1662/2416 [03:23<15:13,  1.21s/it]Iteration:  69%|██████▉   | 1663/2416 [03:25<16:31,  1.32s/it]Iteration:  69%|██████▉   | 1664/2416 [03:26<17:00,  1.36s/it]Iteration:  69%|██████▉   | 1665/2416 [03:27<16:06,  1.29s/it]Iteration:  69%|██████▉   | 1666/2416 [03:28<15:43,  1.26s/it]Iteration:  69%|██████▉   | 1667/2416 [03:31<20:37,  1.65s/it]Iteration:  69%|██████▉   | 1668/2416 [03:32<19:24,  1.56s/it]Iteration:  69%|██████▉   | 1669/2416 [03:34<18:33,  1.49s/it]Iteration:  69%|██████▉   | 1670/2416 [03:35<16:54,  1.36s/it]Iteration:  69%|██████▉   | 1671/2416 [03:36<16:23,  1.32s/it]Iteration:  69%|██████▉   | 1672/2416 [03:37<15:50,  1.28s/it]Iteration:  69%|██████▉   | 1673/2416 [03:38<15:43,  1.27s/it]Iteration:  69%|██████▉   | 1674/2416 [03:40<16:11,  1.31s/it]Iteration:  69%|██████▉   | 1675/2416 [03:42<18:00,  1.46s/it]Iteration:  69%|██████▉   | 1676/2416 [03:43<18:38,  1.51s/it]Iteration:  69%|██████▉   | 1677/2416 [03:45<17:46,  1.44s/it]Iteration:  69%|██████▉   | 1678/2416 [03:46<17:09,  1.40s/it]Iteration:  69%|██████▉   | 1679/2416 [03:47<17:16,  1.41s/it]Iteration:  70%|██████▉   | 1680/2416 [03:49<18:27,  1.50s/it]Iteration:  70%|██████▉   | 1681/2416 [03:50<17:13,  1.41s/it]Iteration:  70%|██████▉   | 1682/2416 [03:52<17:03,  1.39s/it]Iteration:  70%|██████▉   | 1683/2416 [03:53<16:35,  1.36s/it]Iteration:  70%|██████▉   | 1684/2416 [03:54<17:29,  1.43s/it]Iteration:  70%|██████▉   | 1685/2416 [03:56<16:41,  1.37s/it]Iteration:  70%|██████▉   | 1686/2416 [03:57<16:24,  1.35s/it]Iteration:  70%|██████▉   | 1687/2416 [03:58<16:23,  1.35s/it]Iteration:  70%|██████▉   | 1688/2416 [04:00<17:58,  1.48s/it]Iteration:  70%|██████▉   | 1689/2416 [04:01<17:49,  1.47s/it]Iteration:  70%|██████▉   | 1690/2416 [04:03<16:37,  1.37s/it]Iteration:  70%|██████▉   | 1691/2416 [04:05<18:46,  1.55s/it]Iteration:  70%|███████   | 1692/2416 [04:06<16:54,  1.40s/it]Iteration:  70%|███████   | 1693/2416 [04:07<16:24,  1.36s/it]Iteration:  70%|███████   | 1694/2416 [04:08<15:09,  1.26s/it]Iteration:  70%|███████   | 1695/2416 [04:10<16:34,  1.38s/it]Iteration:  70%|███████   | 1696/2416 [04:11<17:28,  1.46s/it]Iteration:  70%|███████   | 1697/2416 [04:13<16:45,  1.40s/it]Iteration:  70%|███████   | 1698/2416 [04:14<15:21,  1.28s/it]Iteration:  70%|███████   | 1699/2416 [04:15<15:38,  1.31s/it]Iteration:  70%|███████   | 1700/2416 [04:16<16:32,  1.39s/it]Iteration:  70%|███████   | 1701/2416 [04:18<16:11,  1.36s/it]Iteration:  70%|███████   | 1702/2416 [04:19<17:27,  1.47s/it]Iteration:  70%|███████   | 1703/2416 [04:21<17:12,  1.45s/it]Iteration:  71%|███████   | 1704/2416 [04:22<16:08,  1.36s/it]Iteration:  71%|███████   | 1705/2416 [04:23<15:44,  1.33s/it]Iteration:  71%|███████   | 1706/2416 [04:24<15:04,  1.27s/it]Iteration:  71%|███████   | 1707/2416 [04:26<15:54,  1.35s/it]Iteration:  71%|███████   | 1708/2416 [04:27<15:40,  1.33s/it]Iteration:  71%|███████   | 1709/2416 [04:29<15:27,  1.31s/it]Iteration:  71%|███████   | 1710/2416 [04:30<16:40,  1.42s/it]Iteration:  71%|███████   | 1711/2416 [04:32<16:34,  1.41s/it]Iteration:  71%|███████   | 1712/2416 [04:33<17:41,  1.51s/it]Iteration:  71%|███████   | 1713/2416 [04:35<18:23,  1.57s/it]Iteration:  71%|███████   | 1714/2416 [04:36<17:35,  1.50s/it]Iteration:  71%|███████   | 1715/2416 [04:37<15:43,  1.35s/it]Iteration:  71%|███████   | 1716/2416 [04:39<15:40,  1.34s/it]Iteration:  71%|███████   | 1717/2416 [04:40<15:07,  1.30s/it]Iteration:  71%|███████   | 1718/2416 [04:41<15:00,  1.29s/it]Iteration:  71%|███████   | 1719/2416 [04:42<14:39,  1.26s/it]Iteration:  71%|███████   | 1720/2416 [04:44<15:39,  1.35s/it]Iteration:  71%|███████   | 1721/2416 [04:45<16:09,  1.40s/it]Iteration:  71%|███████▏  | 1722/2416 [04:47<16:26,  1.42s/it]Iteration:  71%|███████▏  | 1723/2416 [04:48<15:44,  1.36s/it]Iteration:  71%|███████▏  | 1724/2416 [04:50<16:05,  1.40s/it]Iteration:  71%|███████▏  | 1725/2416 [04:51<15:27,  1.34s/it]Iteration:  71%|███████▏  | 1726/2416 [04:52<14:43,  1.28s/it]Iteration:  71%|███████▏  | 1727/2416 [04:53<15:10,  1.32s/it]Iteration:  72%|███████▏  | 1728/2416 [04:54<13:55,  1.21s/it]Iteration:  72%|███████▏  | 1729/2416 [04:56<14:15,  1.24s/it]Iteration:  72%|███████▏  | 1730/2416 [04:57<14:21,  1.26s/it]Iteration:  72%|███████▏  | 1731/2416 [04:58<14:34,  1.28s/it]Iteration:  72%|███████▏  | 1732/2416 [05:00<14:53,  1.31s/it]Iteration:  72%|███████▏  | 1733/2416 [05:01<13:51,  1.22s/it]Iteration:  72%|███████▏  | 1734/2416 [05:02<16:00,  1.41s/it]Iteration:  72%|███████▏  | 1735/2416 [05:04<16:07,  1.42s/it]Iteration:  72%|███████▏  | 1736/2416 [05:05<16:23,  1.45s/it]Iteration:  72%|███████▏  | 1737/2416 [05:07<15:50,  1.40s/it]Iteration:  72%|███████▏  | 1738/2416 [05:08<15:32,  1.38s/it]Iteration:  72%|███████▏  | 1739/2416 [05:10<15:49,  1.40s/it]Iteration:  72%|███████▏  | 1740/2416 [05:11<14:44,  1.31s/it]Iteration:  72%|███████▏  | 1741/2416 [05:12<14:17,  1.27s/it]Iteration:  72%|███████▏  | 1742/2416 [05:13<14:23,  1.28s/it]Iteration:  72%|███████▏  | 1743/2416 [05:15<15:59,  1.43s/it]Iteration:  72%|███████▏  | 1744/2416 [05:16<15:52,  1.42s/it]Iteration:  72%|███████▏  | 1745/2416 [05:18<16:15,  1.45s/it]Iteration:  72%|███████▏  | 1746/2416 [05:19<15:23,  1.38s/it]Iteration:  72%|███████▏  | 1747/2416 [05:20<14:27,  1.30s/it]Iteration:  72%|███████▏  | 1748/2416 [05:22<14:58,  1.35s/it]Iteration:  72%|███████▏  | 1749/2416 [05:23<14:45,  1.33s/it]Iteration:  72%|███████▏  | 1750/2416 [05:24<14:08,  1.27s/it]Iteration:  72%|███████▏  | 1751/2416 [05:25<14:35,  1.32s/it]Iteration:  73%|███████▎  | 1752/2416 [05:27<13:50,  1.25s/it]Iteration:  73%|███████▎  | 1753/2416 [05:28<13:44,  1.24s/it]Iteration:  73%|███████▎  | 1754/2416 [05:29<14:12,  1.29s/it]Iteration:  73%|███████▎  | 1755/2416 [05:30<13:46,  1.25s/it]Iteration:  73%|███████▎  | 1756/2416 [05:32<13:58,  1.27s/it]Iteration:  73%|███████▎  | 1757/2416 [05:33<13:35,  1.24s/it]Iteration:  73%|███████▎  | 1758/2416 [05:34<14:21,  1.31s/it]Iteration:  73%|███████▎  | 1759/2416 [05:35<13:31,  1.24s/it]Iteration:  73%|███████▎  | 1760/2416 [05:37<13:37,  1.25s/it]Iteration:  73%|███████▎  | 1761/2416 [05:38<14:08,  1.30s/it]Iteration:  73%|███████▎  | 1762/2416 [05:40<14:53,  1.37s/it]Iteration:  73%|███████▎  | 1763/2416 [05:41<14:16,  1.31s/it]Iteration:  73%|███████▎  | 1764/2416 [05:42<14:16,  1.31s/it]Iteration:  73%|███████▎  | 1765/2416 [05:43<13:57,  1.29s/it]Iteration:  73%|███████▎  | 1766/2416 [05:45<14:13,  1.31s/it]Iteration:  73%|███████▎  | 1767/2416 [05:46<13:25,  1.24s/it]Iteration:  73%|███████▎  | 1768/2416 [05:47<14:06,  1.31s/it]Iteration:  73%|███████▎  | 1769/2416 [05:49<14:58,  1.39s/it]Iteration:  73%|███████▎  | 1770/2416 [05:50<14:03,  1.31s/it]Iteration:  73%|███████▎  | 1771/2416 [05:51<14:19,  1.33s/it]Iteration:  73%|███████▎  | 1772/2416 [05:52<13:00,  1.21s/it]Iteration:  73%|███████▎  | 1773/2416 [05:54<13:39,  1.27s/it]Iteration:  73%|███████▎  | 1774/2416 [05:55<14:36,  1.37s/it]Iteration:  73%|███████▎  | 1775/2416 [05:56<13:39,  1.28s/it]Iteration:  74%|███████▎  | 1776/2416 [05:58<14:47,  1.39s/it]Iteration:  74%|███████▎  | 1777/2416 [05:59<14:45,  1.39s/it]Iteration:  74%|███████▎  | 1778/2416 [06:00<13:30,  1.27s/it]Iteration:  74%|███████▎  | 1779/2416 [06:02<13:51,  1.31s/it]Iteration:  74%|███████▎  | 1780/2416 [06:03<14:24,  1.36s/it]Iteration:  74%|███████▎  | 1781/2416 [06:05<14:24,  1.36s/it]Iteration:  74%|███████▍  | 1782/2416 [06:06<14:27,  1.37s/it]Iteration:  74%|███████▍  | 1783/2416 [06:07<14:32,  1.38s/it]Iteration:  74%|███████▍  | 1784/2416 [06:09<14:51,  1.41s/it]Iteration:  74%|███████▍  | 1785/2416 [06:10<14:54,  1.42s/it]Iteration:  74%|███████▍  | 1786/2416 [06:11<14:06,  1.34s/it]Iteration:  74%|███████▍  | 1787/2416 [06:12<13:14,  1.26s/it]Iteration:  74%|███████▍  | 1788/2416 [06:14<13:48,  1.32s/it]Iteration:  74%|███████▍  | 1789/2416 [06:15<14:11,  1.36s/it]Iteration:  74%|███████▍  | 1790/2416 [06:17<14:18,  1.37s/it]Iteration:  74%|███████▍  | 1791/2416 [06:18<14:09,  1.36s/it]Iteration:  74%|███████▍  | 1792/2416 [06:19<13:55,  1.34s/it]Iteration:  74%|███████▍  | 1793/2416 [06:20<13:04,  1.26s/it]Iteration:  74%|███████▍  | 1794/2416 [06:22<13:26,  1.30s/it]Iteration:  74%|███████▍  | 1795/2416 [06:23<13:58,  1.35s/it]Iteration:  74%|███████▍  | 1796/2416 [06:25<13:29,  1.31s/it]Iteration:  74%|███████▍  | 1797/2416 [06:26<13:03,  1.27s/it]Iteration:  74%|███████▍  | 1798/2416 [06:27<13:51,  1.35s/it]Iteration:  74%|███████▍  | 1799/2416 [06:29<13:45,  1.34s/it]Iteration:  75%|███████▍  | 1800/2416 [06:30<13:27,  1.31s/it]Iteration:  75%|███████▍  | 1801/2416 [06:32<14:48,  1.44s/it]Iteration:  75%|███████▍  | 1802/2416 [06:33<15:13,  1.49s/it]Iteration:  75%|███████▍  | 1803/2416 [06:35<14:59,  1.47s/it]Iteration:  75%|███████▍  | 1804/2416 [06:36<13:54,  1.36s/it]Iteration:  75%|███████▍  | 1805/2416 [06:37<13:01,  1.28s/it]Iteration:  75%|███████▍  | 1806/2416 [06:38<13:18,  1.31s/it]Iteration:  75%|███████▍  | 1807/2416 [06:39<12:45,  1.26s/it]Iteration:  75%|███████▍  | 1808/2416 [06:41<12:43,  1.26s/it]Iteration:  75%|███████▍  | 1809/2416 [06:42<14:26,  1.43s/it]Iteration:  75%|███████▍  | 1810/2416 [06:44<13:52,  1.37s/it]Iteration:  75%|███████▍  | 1811/2416 [06:45<13:33,  1.34s/it]Iteration:  75%|███████▌  | 1812/2416 [06:47<14:52,  1.48s/it]Iteration:  75%|███████▌  | 1812/2416 [06:47<02:15,  4.45it/s]
