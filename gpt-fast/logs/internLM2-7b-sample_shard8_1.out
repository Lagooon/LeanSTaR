`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 06-24 03:25:59 llm_engine.py:87] Initializing an LLM engine with config: model='/data/user_data/shengyuf/Lean/checkpoints/internlm/internlm2-math-plus-7b/cots', tokenizer='/data/user_data/shengyuf/Lean/checkpoints/internlm/internlm2-math-plus-7b/cots', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 06-24 03:27:08 llm_engine.py:357] # GPU blocks: 12330, # CPU blocks: 2048
Time to load model: 72.98 seconds
Shard size: 24
  0%|          | 0/24 [00:00<?, ?it/s]theorem:  Theorem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='amc12a_2009_p7')

  0%|          | 0/1000 [00:00<?, ?it/s][A
  0%|          | 1/1000 [00:12<3:24:49, 12.30s/it][A
  0%|          | 2/1000 [00:18<2:24:10,  8.67s/it][A
  0%|          | 3/1000 [00:24<2:08:03,  7.71s/it][A
  0%|          | 4/1000 [00:31<1:58:00,  7.11s/it][A
  0%|          | 5/1000 [00:46<2:44:37,  9.93s/it][A
  1%|          | 6/1000 [00:58<3:00:17, 10.88s/it][A
  1%|          | 7/1000 [01:11<3:07:08, 11.31s/it][A
  1%|          | 8/1000 [01:16<2:35:12,  9.39s/it][A
  1%|          | 9/1000 [01:28<2:50:43, 10.34s/it][A
  1%|          | 10/1000 [01:36<2:35:21,  9.42s/it][A
  1%|          | 11/1000 [01:49<2:56:04, 10.68s/it][A
  1%|          | 12/1000 [02:27<5:10:01, 18.83s/it][A
  1%|â–         | 13/1000 [02:33<4:06:19, 14.97s/it][A
  1%|â–         | 14/1000 [02:40<3:26:50, 12.59s/it][A
  2%|â–         | 15/1000 [02:52<3:27:19, 12.63s/it][A
  2%|â–         | 16/1000 [03:07<3:36:15, 13.19s/it][A
  2%|â–         | 17/1000 [03:12<2:57:52, 10.86s/it][A
  2%|â–         | 18/1000 [03:24<3:02:07, 11.13s/it][A
  2%|â–         | 19/1000 [03:32<2:44:37, 10.07s/it][A
  2%|â–         | 20/1000 [03:44<2:52:37, 10.57s/it][A
  2%|â–         | 21/1000 [03:56<3:00:37, 11.07s/it][A
  2%|â–         | 22/1000 [04:01<2:33:49,  9.44s/it][A
  2%|â–         | 23/1000 [04:19<3:12:07, 11.80s/it][A
  2%|â–         | 24/1000 [04:30<3:11:09, 11.75s/it][A
  2%|â–Ž         | 25/1000 [04:36<2:39:51,  9.84s/it][A
  3%|â–Ž         | 26/1000 [04:41<2:15:22,  8.34s/it][A
  3%|â–Ž         | 27/1000 [04:54<2:38:08,  9.75s/it][A
  3%|â–Ž         | 28/1000 [05:00<2:20:25,  8.67s/it][A
  3%|â–Ž         | 29/1000 [05:05<2:01:42,  7.52s/it][A
  3%|â–Ž         | 30/1000 [05:16<2:20:45,  8.71s/it][A
  3%|â–Ž         | 31/1000 [05:29<2:41:01,  9.97s/it][A
  3%|â–Ž         | 32/1000 [05:49<3:27:46, 12.88s/it][A
  3%|â–Ž         | 33/1000 [06:01<3:26:11, 12.79s/it][A
  3%|â–Ž         | 34/1000 [06:16<3:34:02, 13.29s/it][A
  4%|â–Ž         | 35/1000 [06:27<3:23:37, 12.66s/it][A
  4%|â–Ž         | 36/1000 [07:02<5:13:02, 19.48s/it][A
  4%|â–Ž         | 37/1000 [07:08<4:08:44, 15.50s/it][A
  4%|â–         | 38/1000 [07:20<3:49:07, 14.29s/it][A
  4%|â–         | 39/1000 [07:31<3:35:36, 13.46s/it][A
  4%|â–         | 40/1000 [07:42<3:19:44, 12.48s/it][A
  4%|â–         | 41/1000 [08:20<5:21:54, 20.14s/it][A
  4%|â–         | 42/1000 [08:49<6:04:27, 22.83s/it][A
  4%|â–         | 43/1000 [08:57<4:54:16, 18.45s/it][A
  4%|â–         | 44/1000 [09:02<3:50:57, 14.50s/it][A
  4%|â–         | 45/1000 [09:41<5:44:51, 21.67s/it][A
  5%|â–         | 46/1000 [09:52<4:55:34, 18.59s/it][A
  5%|â–         | 47/1000 [10:03<4:20:58, 16.43s/it][A
  5%|â–         | 48/1000 [10:33<5:23:13, 20.37s/it][A
  5%|â–         | 49/1000 [11:01<5:59:28, 22.68s/it][A  5%|â–         | 49/1000 [11:25<3:41:39, 13.99s/it]
  4%|â–         | 1/24 [12:00<4:36:17, 720.77s/it]Error:  EOF
output/internLM2-7b-sample_mathlib_test1/24-06-2024-03-27/results__internLM-7b-math__8.json
0.0
# successes: 	0
theorem:  Theorem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='mathd_algebra_270')

  0%|          | 0/1000 [00:00<?, ?it/s][A
  0%|          | 1/1000 [00:04<1:07:22,  4.05s/it][A  0%|          | 1/1000 [00:08<2:26:54,  8.82s/it]
  8%|â–Š         | 2/24 [12:34<1:56:08, 316.76s/it]output/internLM2-7b-sample_mathlib_test1/24-06-2024-03-27/results__internLM-7b-math__8.json
0.5
# successes: 	1
theorem:  Theorem(repo=LeanGitRepo(url='https://github.com/yangky11/miniF2F-lean4', commit='9e445f5435407f014b88b44a98436d50dd7abd00'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='amc12a_2021_p12')

  0%|          | 0/1000 [00:00<?, ?it/s][A
  0%|          | 1/1000 [00:08<2:16:58,  8.23s/it][A
  0%|          | 2/1000 [00:16<2:14:07,  8.06s/it][A
  0%|          | 3/1000 [00:22<2:03:27,  7.43s/it][A
  0%|          | 4/1000 [00:31<2:11:36,  7.93s/it][A
  0%|          | 5/1000 [01:04<4:41:51, 17.00s/it][A
  1%|          | 6/1000 [01:16<4:14:39, 15.37s/it][A
  1%|          | 7/1000 [01:21<3:18:27, 11.99s/it][A
  1%|          | 8/1000 [01:27<2:42:26,  9.82s/it][A
  1%|          | 9/1000 [01:33<2:23:32,  8.69s/it][A
  1%|          | 10/1000 [01:40<2:16:09,  8.25s/it][A
  1%|          | 11/1000 [01:47<2:09:13,  7.84s/it][A
  1%|          | 12/1000 [01:53<2:01:30,  7.38s/it][A
  1%|â–         | 13/1000 [02:00<1:56:09,  7.06s/it][A
  1%|â–         | 14/1000 [02:05<1:49:25,  6.66s/it][A
  2%|â–         | 15/1000 [02:14<1:57:57,  7.19s/it][A
  2%|â–         | 16/1000 [02:19<1:50:12,  6.72s/it][A
  2%|â–         | 17/1000 [02:25<1:42:46,  6.27s/it][A
  2%|â–         | 18/1000 [02:31<1:42:46,  6.28s/it][A
  2%|â–         | 19/1000 [02:37<1:42:01,  6.24s/it][A
  2%|â–         | 20/1000 [02:43<1:39:12,  6.07s/it][A
  2%|â–         | 21/1000 [02:49<1:38:46,  6.05s/it][A
  2%|â–         | 22/1000 [02:55<1:41:05,  6.20s/it][A
  2%|â–         | 23/1000 [03:06<2:01:09,  7.44s/it][A
  2%|â–         | 24/1000 [03:11<1:52:39,  6.93s/it][A
  2%|â–Ž         | 25/1000 [03:16<1:42:00,  6.28s/it][A
  3%|â–Ž         | 26/1000 [03:22<1:39:12,  6.11s/it][A
  3%|â–Ž         | 27/1000 [03:28<1:39:20,  6.13s/it][A
  3%|â–Ž         | 28/1000 [03:34<1:39:43,  6.16s/it][A
  3%|â–Ž         | 29/1000 [03:40<1:36:49,  5.98s/it][A
  3%|â–Ž         | 30/1000 [03:46<1:39:58,  6.18s/it][A
  3%|â–Ž         | 31/1000 [03:52<1:38:48,  6.12s/it][A
  3%|â–Ž         | 32/1000 [03:59<1:39:45,  6.18s/it][A
  3%|â–Ž         | 33/1000 [04:05<1:42:14,  6.34s/it][A
  3%|â–Ž         | 34/1000 [04:12<1:41:59,  6.34s/it][A
  4%|â–Ž         | 35/1000 [04:17<1:36:53,  6.02s/it][A
  4%|â–Ž         | 36/1000 [04:23<1:36:46,  6.02s/it][A
  4%|â–Ž         | 37/1000 [04:31<1:47:22,  6.69s/it][A
  4%|â–         | 38/1000 [04:38<1:47:35,  6.71s/it][A
  4%|â–         | 39/1000 [04:44<1:42:12,  6.38s/it][A
  4%|â–         | 40/1000 [04:50<1:42:40,  6.42s/it][A
  4%|â–         | 41/1000 [05:02<2:08:12,  8.02s/it][A
  4%|â–         | 42/1000 [05:07<1:55:20,  7.22s/it][A
  4%|â–         | 43/1000 [05:14<1:51:38,  7.00s/it][A
  4%|â–         | 44/1000 [05:20<1:47:35,  6.75s/it][A
  4%|â–         | 45/1000 [05:28<1:54:04,  7.17s/it][A
  5%|â–         | 46/1000 [05:35<1:54:09,  7.18s/it][A
  5%|â–         | 47/1000 [05:42<1:50:30,  6.96s/it][A
  5%|â–         | 48/1000 [05:50<1:57:13,  7.39s/it][A
  5%|â–         | 49/1000 [05:58<2:00:22,  7.59s/it][A
  5%|â–Œ         | 50/1000 [06:05<1:56:08,  7.33s/it][A
  5%|â–Œ         | 51/1000 [06:18<2:23:47,  9.09s/it][A
  5%|â–Œ         | 52/1000 [06:33<2:51:51, 10.88s/it][A
  5%|â–Œ         | 53/1000 [06:39<2:28:20,  9.40s/it][A
  5%|â–Œ         | 54/1000 [06:45<2:09:19,  8.20s/it][A
  6%|â–Œ         | 55/1000 [06:52<2:07:16,  8.08s/it][A
  6%|â–Œ         | 56/1000 [07:00<2:03:39,  7.86s/it][A
  6%|â–Œ         | 57/1000 [07:06<1:55:58,  7.38s/it][A
  6%|â–Œ         | 58/1000 [07:13<1:53:08,  7.21s/it][A
  6%|â–Œ         | 59/1000 [07:19<1:48:24,  6.91s/it][A
  6%|â–Œ         | 60/1000 [07:24<1:39:29,  6.35s/it][A
  6%|â–Œ         | 61/1000 [07:30<1:36:56,  6.19s/it][A
  6%|â–Œ         | 62/1000 [07:35<1:32:05,  5.89s/it][A
  6%|â–‹         | 63/1000 [07:41<1:32:19,  5.91s/it][A