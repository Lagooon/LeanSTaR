`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 05-19 08:20:34 llm_engine.py:87] Initializing an LLM engine with config: model='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 05-19 08:20:43 llm_engine.py:357] # GPU blocks: 27829, # CPU blocks: 2048
Time to load model: 14.86 seconds
Iteration:   0%|          | 0/2416 [00:00<?, ?it/s]Iteration:  75%|███████▌  | 1813/2416 [00:01<00:00, 1410.82it/s]Iteration:  75%|███████▌  | 1813/2416 [00:19<00:00, 1410.82it/s]Iteration:  76%|███████▌  | 1827/2416 [00:20<00:09, 64.78it/s]  Iteration:  76%|███████▌  | 1828/2416 [00:21<00:10, 58.13it/s]Iteration:  76%|███████▌  | 1828/2416 [00:39<00:10, 58.13it/s]Iteration:  76%|███████▋  | 1843/2416 [00:41<00:26, 21.29it/s]Iteration:  76%|███████▋  | 1844/2416 [00:42<00:28, 19.88it/s]Iteration:  76%|███████▋  | 1844/2416 [00:59<00:28, 19.88it/s]Iteration:  77%|███████▋  | 1858/2416 [01:00<00:57,  9.70it/s]Iteration:  77%|███████▋  | 1859/2416 [01:02<01:00,  9.18it/s]Iteration:  77%|███████▋  | 1859/2416 [01:19<01:00,  9.18it/s]Iteration:  78%|███████▊  | 1873/2416 [01:20<01:48,  4.99it/s]Iteration:  78%|███████▊  | 1874/2416 [01:21<01:52,  4.81it/s]Iteration:  78%|███████▊  | 1887/2416 [01:39<03:09,  2.79it/s]Iteration:  78%|███████▊  | 1888/2416 [01:40<03:15,  2.69it/s]Iteration:  79%|███████▊  | 1897/2416 [01:52<04:28,  1.94it/s]Iteration:  79%|███████▊  | 1898/2416 [01:53<04:37,  1.86it/s]Iteration:  79%|███████▉  | 1904/2416 [02:00<05:33,  1.54it/s]Iteration:  79%|███████▉  | 1908/2416 [02:05<06:06,  1.39it/s]Iteration:  79%|███████▉  | 1911/2416 [02:09<06:43,  1.25it/s]Iteration:  79%|███████▉  | 1913/2416 [02:12<07:15,  1.15it/s]Iteration:  79%|███████▉  | 1915/2416 [02:14<07:36,  1.10it/s]Iteration:  79%|███████▉  | 1916/2416 [02:15<07:50,  1.06it/s]Iteration:  79%|███████▉  | 1917/2416 [02:17<08:02,  1.03it/s]Iteration:  79%|███████▉  | 1918/2416 [02:18<08:27,  1.02s/it]Iteration:  79%|███████▉  | 1919/2416 [02:20<09:23,  1.13s/it]Iteration:  79%|███████▉  | 1920/2416 [02:21<09:05,  1.10s/it]Iteration:  80%|███████▉  | 1921/2416 [02:22<09:48,  1.19s/it]Iteration:  80%|███████▉  | 1922/2416 [02:23<09:59,  1.21s/it]Iteration:  80%|███████▉  | 1923/2416 [02:25<10:38,  1.30s/it]Iteration:  80%|███████▉  | 1924/2416 [02:26<10:08,  1.24s/it]Iteration:  80%|███████▉  | 1925/2416 [02:27<10:04,  1.23s/it]Iteration:  80%|███████▉  | 1926/2416 [02:29<10:23,  1.27s/it]Iteration:  80%|███████▉  | 1927/2416 [02:30<10:11,  1.25s/it]Iteration:  80%|███████▉  | 1928/2416 [02:31<09:59,  1.23s/it]Iteration:  80%|███████▉  | 1929/2416 [02:32<10:01,  1.24s/it]Iteration:  80%|███████▉  | 1930/2416 [02:33<10:07,  1.25s/it]Iteration:  80%|███████▉  | 1931/2416 [02:35<10:19,  1.28s/it]Iteration:  80%|███████▉  | 1932/2416 [02:36<09:45,  1.21s/it]Iteration:  80%|████████  | 1933/2416 [02:37<10:31,  1.31s/it]Iteration:  80%|████████  | 1934/2416 [02:39<10:47,  1.34s/it]Iteration:  80%|████████  | 1935/2416 [02:40<10:36,  1.32s/it]Iteration:  80%|████████  | 1936/2416 [02:42<10:47,  1.35s/it]Iteration:  80%|████████  | 1937/2416 [02:43<10:08,  1.27s/it]Iteration:  80%|████████  | 1938/2416 [02:44<10:31,  1.32s/it]Iteration:  80%|████████  | 1939/2416 [02:45<09:51,  1.24s/it]Iteration:  80%|████████  | 1940/2416 [02:46<10:08,  1.28s/it]Iteration:  80%|████████  | 1941/2416 [02:48<11:36,  1.47s/it]Iteration:  80%|████████  | 1942/2416 [02:49<10:42,  1.35s/it]Iteration:  80%|████████  | 1943/2416 [02:51<10:57,  1.39s/it]Iteration:  80%|████████  | 1944/2416 [02:52<10:19,  1.31s/it]Iteration:  81%|████████  | 1945/2416 [02:54<10:32,  1.34s/it]Iteration:  81%|████████  | 1946/2416 [02:55<10:33,  1.35s/it]Iteration:  81%|████████  | 1947/2416 [02:56<10:48,  1.38s/it]Iteration:  81%|████████  | 1948/2416 [02:58<11:20,  1.45s/it]Iteration:  81%|████████  | 1949/2416 [02:59<10:37,  1.36s/it]Iteration:  81%|████████  | 1950/2416 [03:00<10:03,  1.30s/it]Iteration:  81%|████████  | 1951/2416 [03:02<10:58,  1.42s/it]Iteration:  81%|████████  | 1952/2416 [03:03<10:58,  1.42s/it]Iteration:  81%|████████  | 1953/2416 [03:05<10:41,  1.39s/it]Iteration:  81%|████████  | 1954/2416 [03:06<10:54,  1.42s/it]Iteration:  81%|████████  | 1955/2416 [03:07<09:50,  1.28s/it]Iteration:  81%|████████  | 1956/2416 [03:09<10:10,  1.33s/it]Iteration:  81%|████████  | 1957/2416 [03:10<09:43,  1.27s/it]Iteration:  81%|████████  | 1958/2416 [03:11<10:52,  1.42s/it]Iteration:  81%|████████  | 1959/2416 [03:13<10:33,  1.39s/it]Iteration:  81%|████████  | 1960/2416 [03:14<10:50,  1.43s/it]Iteration:  81%|████████  | 1961/2416 [03:16<10:34,  1.39s/it]Iteration:  81%|████████  | 1962/2416 [03:17<10:29,  1.39s/it]Iteration:  81%|████████▏ | 1963/2416 [03:18<10:40,  1.41s/it]Iteration:  81%|████████▏ | 1964/2416 [03:19<09:43,  1.29s/it]Iteration:  81%|████████▏ | 1965/2416 [03:21<09:40,  1.29s/it]Iteration:  81%|████████▏ | 1966/2416 [03:22<09:26,  1.26s/it]Iteration:  81%|████████▏ | 1967/2416 [03:23<08:59,  1.20s/it]Iteration:  81%|████████▏ | 1968/2416 [03:24<09:15,  1.24s/it]Iteration:  81%|████████▏ | 1969/2416 [03:26<09:12,  1.24s/it]Iteration:  82%|████████▏ | 1970/2416 [03:27<09:35,  1.29s/it]Iteration:  82%|████████▏ | 1971/2416 [03:28<09:56,  1.34s/it]Iteration:  82%|████████▏ | 1972/2416 [03:30<09:57,  1.35s/it]Iteration:  82%|████████▏ | 1973/2416 [03:31<09:37,  1.30s/it]Iteration:  82%|████████▏ | 1974/2416 [03:33<10:26,  1.42s/it]Iteration:  82%|████████▏ | 1975/2416 [03:34<11:12,  1.52s/it]Iteration:  82%|████████▏ | 1976/2416 [03:36<11:12,  1.53s/it]Iteration:  82%|████████▏ | 1977/2416 [03:37<10:29,  1.43s/it]Iteration:  82%|████████▏ | 1978/2416 [03:38<09:52,  1.35s/it]Iteration:  82%|████████▏ | 1979/2416 [03:40<09:57,  1.37s/it]Iteration:  82%|████████▏ | 1980/2416 [03:41<09:35,  1.32s/it]Iteration:  82%|████████▏ | 1981/2416 [03:42<09:24,  1.30s/it]Iteration:  82%|████████▏ | 1982/2416 [03:43<08:55,  1.23s/it]Iteration:  82%|████████▏ | 1983/2416 [03:44<08:41,  1.20s/it]Iteration:  82%|████████▏ | 1984/2416 [03:46<09:19,  1.29s/it]Iteration:  82%|████████▏ | 1985/2416 [03:47<09:36,  1.34s/it]Iteration:  82%|████████▏ | 1986/2416 [03:49<09:32,  1.33s/it]Iteration:  82%|████████▏ | 1987/2416 [03:50<09:44,  1.36s/it]Iteration:  82%|████████▏ | 1988/2416 [03:51<09:21,  1.31s/it]Iteration:  82%|████████▏ | 1989/2416 [03:53<09:38,  1.36s/it]Iteration:  82%|████████▏ | 1990/2416 [03:54<09:02,  1.27s/it]Iteration:  82%|████████▏ | 1991/2416 [03:56<10:08,  1.43s/it]Iteration:  82%|████████▏ | 1992/2416 [03:57<09:59,  1.41s/it]Iteration:  82%|████████▏ | 1993/2416 [03:58<09:50,  1.40s/it]Iteration:  83%|████████▎ | 1994/2416 [04:00<09:20,  1.33s/it]Iteration:  83%|████████▎ | 1995/2416 [04:01<09:21,  1.33s/it]Iteration:  83%|████████▎ | 1996/2416 [04:02<09:17,  1.33s/it]Iteration:  83%|████████▎ | 1997/2416 [04:03<08:51,  1.27s/it]Iteration:  83%|████████▎ | 1998/2416 [04:05<08:52,  1.27s/it]Iteration:  83%|████████▎ | 1999/2416 [04:06<08:13,  1.18s/it]Iteration:  83%|████████▎ | 2000/2416 [04:07<08:29,  1.22s/it]Iteration:  83%|████████▎ | 2001/2416 [04:08<08:37,  1.25s/it]Iteration:  83%|████████▎ | 2002/2416 [04:09<08:35,  1.24s/it]Iteration:  83%|████████▎ | 2003/2416 [04:11<08:26,  1.23s/it]Iteration:  83%|████████▎ | 2004/2416 [04:12<08:53,  1.30s/it]Iteration:  83%|████████▎ | 2005/2416 [04:14<09:16,  1.35s/it]Iteration:  83%|████████▎ | 2006/2416 [04:15<09:04,  1.33s/it]Iteration:  83%|████████▎ | 2007/2416 [04:16<09:15,  1.36s/it]Iteration:  83%|████████▎ | 2008/2416 [04:18<09:00,  1.32s/it]Iteration:  83%|████████▎ | 2009/2416 [04:19<08:40,  1.28s/it]Iteration:  83%|████████▎ | 2010/2416 [04:20<08:19,  1.23s/it]Iteration:  83%|████████▎ | 2011/2416 [04:21<08:39,  1.28s/it]Iteration:  83%|████████▎ | 2012/2416 [04:22<08:14,  1.22s/it]Iteration:  83%|████████▎ | 2013/2416 [04:24<08:13,  1.22s/it]Iteration:  83%|████████▎ | 2014/2416 [04:25<08:40,  1.30s/it]Iteration:  83%|████████▎ | 2015/2416 [04:26<08:03,  1.21s/it]Iteration:  83%|████████▎ | 2016/2416 [04:27<08:25,  1.26s/it]Iteration:  83%|████████▎ | 2017/2416 [04:29<09:01,  1.36s/it]Iteration:  84%|████████▎ | 2018/2416 [04:31<09:28,  1.43s/it]Iteration:  84%|████████▎ | 2019/2416 [04:32<09:19,  1.41s/it]Iteration:  84%|████████▎ | 2020/2416 [04:34<09:42,  1.47s/it]Iteration:  84%|████████▎ | 2021/2416 [04:35<09:43,  1.48s/it]Iteration:  84%|████████▎ | 2022/2416 [04:37<09:46,  1.49s/it]Iteration:  84%|████████▎ | 2023/2416 [04:38<09:40,  1.48s/it]Iteration:  84%|████████▍ | 2024/2416 [04:39<09:09,  1.40s/it]Iteration:  84%|████████▍ | 2025/2416 [04:41<08:54,  1.37s/it]Iteration:  84%|████████▍ | 2026/2416 [04:42<09:16,  1.43s/it]Iteration:  84%|████████▍ | 2027/2416 [04:43<08:41,  1.34s/it]Iteration:  84%|████████▍ | 2028/2416 [04:45<08:32,  1.32s/it]Iteration:  84%|████████▍ | 2029/2416 [04:46<08:28,  1.31s/it]Iteration:  84%|████████▍ | 2030/2416 [04:48<09:30,  1.48s/it]Iteration:  84%|████████▍ | 2031/2416 [04:49<09:35,  1.50s/it]Iteration:  84%|████████▍ | 2032/2416 [04:50<08:57,  1.40s/it]Iteration:  84%|████████▍ | 2033/2416 [04:52<08:29,  1.33s/it]Iteration:  84%|████████▍ | 2034/2416 [04:53<08:34,  1.35s/it]Iteration:  84%|████████▍ | 2035/2416 [04:55<09:01,  1.42s/it]Iteration:  84%|████████▍ | 2036/2416 [04:56<08:13,  1.30s/it]Iteration:  84%|████████▍ | 2037/2416 [04:57<07:56,  1.26s/it]Iteration:  84%|████████▍ | 2038/2416 [04:58<07:54,  1.25s/it]Iteration:  84%|████████▍ | 2039/2416 [04:59<07:57,  1.27s/it]Iteration:  84%|████████▍ | 2040/2416 [05:01<08:20,  1.33s/it]Iteration:  84%|████████▍ | 2041/2416 [05:02<08:35,  1.37s/it]Iteration:  85%|████████▍ | 2042/2416 [05:04<08:35,  1.38s/it]Iteration:  85%|████████▍ | 2043/2416 [05:05<08:58,  1.44s/it]Iteration:  85%|████████▍ | 2044/2416 [05:07<09:09,  1.48s/it]Iteration:  85%|████████▍ | 2045/2416 [05:08<08:54,  1.44s/it]Iteration:  85%|████████▍ | 2046/2416 [05:10<08:52,  1.44s/it]Iteration:  85%|████████▍ | 2047/2416 [05:11<08:43,  1.42s/it]Iteration:  85%|████████▍ | 2048/2416 [05:12<08:48,  1.44s/it]Iteration:  85%|████████▍ | 2049/2416 [05:13<08:03,  1.32s/it]Iteration:  85%|████████▍ | 2050/2416 [05:15<07:48,  1.28s/it]Iteration:  85%|████████▍ | 2051/2416 [05:16<07:36,  1.25s/it]Iteration:  85%|████████▍ | 2052/2416 [05:17<07:43,  1.27s/it]Iteration:  85%|████████▍ | 2053/2416 [05:19<08:37,  1.43s/it]Iteration:  85%|████████▌ | 2054/2416 [05:20<08:18,  1.38s/it]Iteration:  85%|████████▌ | 2055/2416 [05:22<08:19,  1.38s/it]Iteration:  85%|████████▌ | 2056/2416 [05:23<08:22,  1.40s/it]Iteration:  85%|████████▌ | 2057/2416 [05:24<08:12,  1.37s/it]Iteration:  85%|████████▌ | 2058/2416 [05:26<08:09,  1.37s/it]Iteration:  85%|████████▌ | 2059/2416 [05:27<08:12,  1.38s/it]Iteration:  85%|████████▌ | 2060/2416 [05:28<07:42,  1.30s/it]Iteration:  85%|████████▌ | 2061/2416 [05:29<07:36,  1.29s/it]Iteration:  85%|████████▌ | 2062/2416 [05:31<08:50,  1.50s/it]Iteration:  85%|████████▌ | 2063/2416 [05:33<08:16,  1.41s/it]Iteration:  85%|████████▌ | 2064/2416 [05:34<08:01,  1.37s/it]Iteration:  85%|████████▌ | 2065/2416 [05:36<08:23,  1.44s/it]Iteration:  86%|████████▌ | 2066/2416 [05:37<08:00,  1.37s/it]Iteration:  86%|████████▌ | 2067/2416 [05:38<08:00,  1.38s/it]Iteration:  86%|████████▌ | 2068/2416 [05:39<07:51,  1.35s/it]Iteration:  86%|████████▌ | 2069/2416 [05:41<07:58,  1.38s/it]Iteration:  86%|████████▌ | 2070/2416 [05:42<07:33,  1.31s/it]Iteration:  86%|████████▌ | 2071/2416 [05:43<07:12,  1.25s/it]Iteration:  86%|████████▌ | 2072/2416 [05:44<06:59,  1.22s/it]Iteration:  86%|████████▌ | 2073/2416 [05:46<07:07,  1.25s/it]Iteration:  86%|████████▌ | 2074/2416 [05:47<07:02,  1.24s/it]Iteration:  86%|████████▌ | 2075/2416 [05:48<07:10,  1.26s/it]Iteration:  86%|████████▌ | 2076/2416 [05:49<07:14,  1.28s/it]Iteration:  86%|████████▌ | 2077/2416 [05:51<07:22,  1.31s/it]Iteration:  86%|████████▌ | 2078/2416 [05:52<07:52,  1.40s/it]Iteration:  86%|████████▌ | 2079/2416 [05:53<07:10,  1.28s/it]Iteration:  86%|████████▌ | 2080/2416 [05:55<07:01,  1.25s/it]Iteration:  86%|████████▌ | 2081/2416 [05:56<06:49,  1.22s/it]Iteration:  86%|████████▌ | 2082/2416 [05:57<06:43,  1.21s/it]Iteration:  86%|████████▌ | 2083/2416 [05:58<06:45,  1.22s/it]Iteration:  86%|████████▋ | 2084/2416 [05:59<06:45,  1.22s/it]Iteration:  86%|████████▋ | 2085/2416 [06:01<07:19,  1.33s/it]Iteration:  86%|████████▋ | 2086/2416 [06:03<07:44,  1.41s/it]Iteration:  86%|████████▋ | 2087/2416 [06:04<07:40,  1.40s/it]Iteration:  86%|████████▋ | 2088/2416 [06:05<07:32,  1.38s/it]Iteration:  86%|████████▋ | 2089/2416 [06:06<07:08,  1.31s/it]Iteration:  87%|████████▋ | 2090/2416 [06:09<08:29,  1.56s/it]Iteration:  87%|████████▋ | 2091/2416 [06:10<08:03,  1.49s/it]Iteration:  87%|████████▋ | 2092/2416 [06:11<07:29,  1.39s/it]Iteration:  87%|████████▋ | 2093/2416 [06:12<06:54,  1.28s/it]Iteration:  87%|████████▋ | 2094/2416 [06:13<06:43,  1.25s/it]Iteration:  87%|████████▋ | 2095/2416 [06:15<06:46,  1.27s/it]Iteration:  87%|████████▋ | 2096/2416 [06:16<07:00,  1.31s/it]Iteration:  87%|████████▋ | 2097/2416 [06:17<07:02,  1.33s/it]Iteration:  87%|████████▋ | 2098/2416 [06:19<07:09,  1.35s/it]Iteration:  87%|████████▋ | 2099/2416 [06:20<06:52,  1.30s/it]Iteration:  87%|████████▋ | 2100/2416 [06:21<06:59,  1.33s/it]Iteration:  87%|████████▋ | 2101/2416 [06:23<06:58,  1.33s/it]Iteration:  87%|████████▋ | 2102/2416 [06:24<07:22,  1.41s/it]Iteration:  87%|████████▋ | 2103/2416 [06:25<06:59,  1.34s/it]Iteration:  87%|████████▋ | 2104/2416 [06:26<06:30,  1.25s/it]Iteration:  87%|████████▋ | 2105/2416 [06:28<06:26,  1.24s/it]Iteration:  87%|████████▋ | 2106/2416 [06:29<06:14,  1.21s/it]Iteration:  87%|████████▋ | 2107/2416 [06:30<06:12,  1.20s/it]Iteration:  87%|████████▋ | 2108/2416 [06:31<06:18,  1.23s/it]Iteration:  87%|████████▋ | 2109/2416 [06:32<06:10,  1.21s/it]Iteration:  87%|████████▋ | 2110/2416 [06:34<06:01,  1.18s/it]Iteration:  87%|████████▋ | 2111/2416 [06:35<06:00,  1.18s/it]Iteration:  87%|████████▋ | 2112/2416 [06:36<06:04,  1.20s/it]Iteration:  87%|████████▋ | 2113/2416 [06:37<06:05,  1.21s/it]Iteration:  88%|████████▊ | 2114/2416 [06:39<06:16,  1.25s/it]Iteration:  88%|████████▊ | 2114/2416 [06:39<00:57,  5.30it/s]
