`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 04-06 14:45:38 llm_engine.py:87] Initializing an LLM engine with config: model='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/dpo', tokenizer='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/dpo', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 04-06 14:45:45 llm_engine.py:357] # GPU blocks: 28341, # CPU blocks: 2048
2024-04-06 14:45:50.275 | WARNING  | lean_dojo.data_extraction.lean:__post_init__:442 - LeanGitRepo(url='https://github.com/rah4927/lean-dojo-mew', commit='d00c776260c77de7e70125ef0cd119de6c0ff1de') relies on an unsupported Lean version: 63d2bdd4908b4df7db381537af754a7319e334e4
Time to load model: 10.22 seconds
Shard size: 61
  0%|          | 0/61 [00:00<?, ?it/s]2024-04-06 14:45:50.836 | INFO     | lean_dojo.data_extraction.trace:get_traced_repo_path:79 - Tracing LeanGitRepo(url='https://github.com/rah4927/lean-dojo-mew', commit='d00c776260c77de7e70125ef0cd119de6c0ff1de')
2024-04-06 14:45:51.457 | INFO     | __main__:main:165 - Building lean-dojo-mew
error: toolchain 'leanprover/lean4:nightly-2023-08-19' does not have the binary `/home/zhiqings/.elan/toolchains/leanprover--lean4---nightly-2023-08-19/bin/lake`
Traceback (most recent call last):
  File "/nobackup/users/zhiqings/haohanl/tmp/tmp0du70bl2/workspace/build_lean4_repo.py", line 200, in <module>
    main()
  File "/nobackup/users/zhiqings/haohanl/tmp/tmp0du70bl2/workspace/build_lean4_repo.py", line 172, in main
    run_cmd("lake build")
  File "/nobackup/users/zhiqings/haohanl/tmp/tmp0du70bl2/workspace/build_lean4_repo.py", line 29, in run_cmd
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'lake build' returned non-zero exit status 1.
  0%|          | 0/61 [00:01<?, ?it/s]
Theorem(repo=LeanGitRepo(url='https://github.com/rah4927/lean-dojo-mew', commit='d00c776260c77de7e70125ef0cd119de6c0ff1de'), file_path=PosixPath('MiniF2F/Test.lean'), full_name='algebra_9onxpypzleqsum2onxpy')
Traceback (most recent call last):
  File "/nobackup/users/zhiqings/haohanl/LeanCOT/gpt-fast/batched_search.py", line 1004, in <module>
    main(
  File "/nobackup/users/zhiqings/haohanl/LeanCOT/gpt-fast/batched_search.py", line 802, in main
    attempt_results = best_first_search(
  File "/nobackup/users/zhiqings/haohanl/LeanCOT/gpt-fast/batched_search.py", line 463, in best_first_search
    with Dojo(theorem, hard_timeout=timeout) as (dojo, init_state):
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 265, in __enter__
    raise ex
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/interaction/dojo.py", line 185, in __enter__
    traced_repo_path = get_traced_repo_path(self.repo)
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/data_extraction/trace.py", line 82, in get_traced_repo_path
    _trace(repo, build_deps)
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/data_extraction/trace.py", line 57, in _trace
    raise ex
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/data_extraction/trace.py", line 45, in _trace
    container.run(
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/container.py", line 194, in run
    execute(cmd, capture_output=capture_output)
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/utils.py", line 116, in execute
    raise ex
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/site-packages/lean_dojo/utils.py", line 111, in execute
    res = subprocess.run(cmd, shell=True, capture_output=capture_output, check=True)
  File "/nobackup/users/zhiqings/haohanl/lean1/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command 'NUM_PROCS=32 python build_lean4_repo.py lean-dojo-mew' returned non-zero exit status 1.
