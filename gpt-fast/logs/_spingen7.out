`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 05-19 08:20:36 llm_engine.py:87] Initializing an LLM engine with config: model='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 05-19 08:20:43 llm_engine.py:357] # GPU blocks: 27829, # CPU blocks: 2048
Time to load model: 14.78 seconds
Iteration:   0%|          | 0/2416 [00:00<?, ?it/s]Iteration:  88%|████████▊ | 2115/2416 [00:01<00:00, 1523.35it/s]Iteration:  88%|████████▊ | 2115/2416 [00:19<00:00, 1523.35it/s]Iteration:  88%|████████▊ | 2129/2416 [00:20<00:03, 76.27it/s]  Iteration:  88%|████████▊ | 2130/2416 [00:21<00:04, 69.11it/s]Iteration:  88%|████████▊ | 2130/2416 [00:39<00:04, 69.11it/s]Iteration:  89%|████████▊ | 2144/2416 [00:40<00:10, 24.89it/s]Iteration:  89%|████████▉ | 2145/2416 [00:42<00:11, 23.16it/s]Iteration:  89%|████████▉ | 2145/2416 [00:59<00:11, 23.16it/s]Iteration:  89%|████████▉ | 2157/2416 [01:01<00:23, 11.00it/s]Iteration:  89%|████████▉ | 2158/2416 [01:02<00:24, 10.58it/s]Iteration:  89%|████████▉ | 2158/2416 [01:19<00:24, 10.58it/s]Iteration:  90%|████████▉ | 2172/2416 [01:20<00:43,  5.55it/s]Iteration:  90%|████████▉ | 2173/2416 [01:21<00:45,  5.35it/s]Iteration:  90%|████████▉ | 2173/2416 [01:39<00:45,  5.35it/s]Iteration:  91%|█████████ | 2187/2416 [01:40<01:14,  3.06it/s]Iteration:  91%|█████████ | 2188/2416 [01:41<01:17,  2.95it/s]Iteration:  91%|█████████ | 2197/2416 [01:53<01:45,  2.07it/s]Iteration:  91%|█████████ | 2198/2416 [01:55<01:49,  1.99it/s]Iteration:  91%|█████████ | 2204/2416 [02:02<02:11,  1.61it/s]Iteration:  91%|█████████▏| 2209/2416 [02:09<02:29,  1.39it/s]Iteration:  92%|█████████▏| 2212/2416 [02:13<02:46,  1.23it/s]Iteration:  92%|█████████▏| 2214/2416 [02:16<02:58,  1.13it/s]Iteration:  92%|█████████▏| 2216/2416 [02:18<03:01,  1.10it/s]Iteration:  92%|█████████▏| 2217/2416 [02:19<03:05,  1.07it/s]Iteration:  92%|█████████▏| 2218/2416 [02:21<03:10,  1.04it/s]Iteration:  92%|█████████▏| 2219/2416 [02:22<03:13,  1.02it/s]Iteration:  92%|█████████▏| 2220/2416 [02:23<03:25,  1.05s/it]Iteration:  92%|█████████▏| 2221/2416 [02:24<03:25,  1.06s/it]Iteration:  92%|█████████▏| 2222/2416 [02:26<03:43,  1.15s/it]Iteration:  92%|█████████▏| 2223/2416 [02:27<03:47,  1.18s/it]Iteration:  92%|█████████▏| 2224/2416 [02:28<03:50,  1.20s/it]Iteration:  92%|█████████▏| 2225/2416 [02:30<04:01,  1.27s/it]Iteration:  92%|█████████▏| 2226/2416 [02:31<03:59,  1.26s/it]Iteration:  92%|█████████▏| 2227/2416 [02:32<04:05,  1.30s/it]Iteration:  92%|█████████▏| 2228/2416 [02:34<04:07,  1.31s/it]Iteration:  92%|█████████▏| 2229/2416 [02:35<03:58,  1.27s/it]Iteration:  92%|█████████▏| 2230/2416 [02:36<03:57,  1.28s/it]Iteration:  92%|█████████▏| 2231/2416 [02:38<03:53,  1.26s/it]Iteration:  92%|█████████▏| 2232/2416 [02:39<03:53,  1.27s/it]Iteration:  92%|█████████▏| 2233/2416 [02:41<04:18,  1.41s/it]Iteration:  92%|█████████▏| 2234/2416 [02:42<04:13,  1.39s/it]Iteration:  93%|█████████▎| 2235/2416 [02:43<04:07,  1.37s/it]Iteration:  93%|█████████▎| 2236/2416 [02:45<04:02,  1.35s/it]Iteration:  93%|█████████▎| 2237/2416 [02:46<04:09,  1.39s/it]Iteration:  93%|█████████▎| 2238/2416 [02:47<03:59,  1.35s/it]Iteration:  93%|█████████▎| 2239/2416 [02:49<04:10,  1.42s/it]Iteration:  93%|█████████▎| 2240/2416 [02:50<03:52,  1.32s/it]Iteration:  93%|█████████▎| 2241/2416 [02:51<03:46,  1.29s/it]Iteration:  93%|█████████▎| 2242/2416 [02:52<03:35,  1.24s/it]Iteration:  93%|█████████▎| 2243/2416 [02:53<03:32,  1.23s/it]Iteration:  93%|█████████▎| 2244/2416 [02:55<03:38,  1.27s/it]Iteration:  93%|█████████▎| 2245/2416 [02:56<03:46,  1.32s/it]Iteration:  93%|█████████▎| 2246/2416 [02:58<04:02,  1.43s/it]Iteration:  93%|█████████▎| 2247/2416 [02:59<03:40,  1.30s/it]Iteration:  93%|█████████▎| 2248/2416 [03:00<03:31,  1.26s/it]Iteration:  93%|█████████▎| 2249/2416 [03:01<03:22,  1.21s/it]Iteration:  93%|█████████▎| 2250/2416 [03:03<03:45,  1.36s/it]Iteration:  93%|█████████▎| 2251/2416 [03:04<03:39,  1.33s/it]Iteration:  93%|█████████▎| 2252/2416 [03:05<03:28,  1.27s/it]Iteration:  93%|█████████▎| 2253/2416 [03:07<03:24,  1.26s/it]Iteration:  93%|█████████▎| 2254/2416 [03:08<03:18,  1.23s/it]Iteration:  93%|█████████▎| 2255/2416 [03:09<03:24,  1.27s/it]Iteration:  93%|█████████▎| 2256/2416 [03:10<03:21,  1.26s/it]Iteration:  93%|█████████▎| 2257/2416 [03:12<03:33,  1.34s/it]Iteration:  93%|█████████▎| 2258/2416 [03:13<03:38,  1.38s/it]Iteration:  94%|█████████▎| 2259/2416 [03:15<03:38,  1.39s/it]Iteration:  94%|█████████▎| 2260/2416 [03:16<03:28,  1.34s/it]Iteration:  94%|█████████▎| 2261/2416 [03:17<03:28,  1.34s/it]Iteration:  94%|█████████▎| 2262/2416 [03:18<03:12,  1.25s/it]Iteration:  94%|█████████▎| 2263/2416 [03:19<03:02,  1.19s/it]Iteration:  94%|█████████▎| 2264/2416 [03:21<02:56,  1.16s/it]Iteration:  94%|█████████▍| 2265/2416 [03:22<03:02,  1.21s/it]Iteration:  94%|█████████▍| 2266/2416 [03:23<03:00,  1.20s/it]Iteration:  94%|█████████▍| 2267/2416 [03:24<03:01,  1.22s/it]Iteration:  94%|█████████▍| 2268/2416 [03:26<03:10,  1.29s/it]Iteration:  94%|█████████▍| 2269/2416 [03:27<03:07,  1.28s/it]Iteration:  94%|█████████▍| 2270/2416 [03:28<03:06,  1.28s/it]Iteration:  94%|█████████▍| 2271/2416 [03:30<03:24,  1.41s/it]Iteration:  94%|█████████▍| 2272/2416 [03:31<03:07,  1.30s/it]Iteration:  94%|█████████▍| 2273/2416 [03:33<03:24,  1.43s/it]Iteration:  94%|█████████▍| 2274/2416 [03:34<03:13,  1.36s/it]Iteration:  94%|█████████▍| 2275/2416 [03:35<02:57,  1.26s/it]Iteration:  94%|█████████▍| 2276/2416 [03:36<02:54,  1.25s/it]Iteration:  94%|█████████▍| 2277/2416 [03:37<02:48,  1.21s/it]Iteration:  94%|█████████▍| 2278/2416 [03:39<03:00,  1.31s/it]Iteration:  94%|█████████▍| 2279/2416 [03:40<03:05,  1.36s/it]Iteration:  94%|█████████▍| 2280/2416 [03:42<03:15,  1.44s/it]Iteration:  94%|█████████▍| 2281/2416 [03:44<03:38,  1.62s/it]Iteration:  94%|█████████▍| 2282/2416 [03:46<03:35,  1.61s/it]Iteration:  94%|█████████▍| 2283/2416 [03:47<03:20,  1.50s/it]Iteration:  95%|█████████▍| 2284/2416 [03:48<02:56,  1.33s/it]Iteration:  95%|█████████▍| 2285/2416 [03:49<02:53,  1.33s/it]Iteration:  95%|█████████▍| 2286/2416 [03:50<02:55,  1.35s/it]Iteration:  95%|█████████▍| 2287/2416 [03:52<02:50,  1.32s/it]Iteration:  95%|█████████▍| 2288/2416 [03:53<02:58,  1.39s/it]Iteration:  95%|█████████▍| 2289/2416 [03:55<03:05,  1.46s/it]Iteration:  95%|█████████▍| 2290/2416 [03:56<03:00,  1.43s/it]Iteration:  95%|█████████▍| 2291/2416 [03:58<03:09,  1.52s/it]Iteration:  95%|█████████▍| 2292/2416 [04:00<03:08,  1.52s/it]Iteration:  95%|█████████▍| 2293/2416 [04:01<02:54,  1.42s/it]Iteration:  95%|█████████▍| 2294/2416 [04:02<02:44,  1.35s/it]Iteration:  95%|█████████▍| 2295/2416 [04:03<02:38,  1.31s/it]Iteration:  95%|█████████▌| 2296/2416 [04:04<02:38,  1.32s/it]Iteration:  95%|█████████▌| 2297/2416 [04:06<02:37,  1.32s/it]Iteration:  95%|█████████▌| 2298/2416 [04:07<02:31,  1.29s/it]Iteration:  95%|█████████▌| 2299/2416 [04:08<02:26,  1.25s/it]Iteration:  95%|█████████▌| 2300/2416 [04:09<02:26,  1.27s/it]Iteration:  95%|█████████▌| 2301/2416 [04:11<02:38,  1.37s/it]Iteration:  95%|█████████▌| 2302/2416 [04:12<02:36,  1.38s/it]Iteration:  95%|█████████▌| 2303/2416 [04:14<02:28,  1.31s/it]Iteration:  95%|█████████▌| 2304/2416 [04:15<02:23,  1.28s/it]Iteration:  95%|█████████▌| 2305/2416 [04:16<02:24,  1.30s/it]Iteration:  95%|█████████▌| 2306/2416 [04:18<02:34,  1.40s/it]Iteration:  95%|█████████▌| 2307/2416 [04:19<02:30,  1.38s/it]Iteration:  96%|█████████▌| 2308/2416 [04:21<02:31,  1.40s/it]Iteration:  96%|█████████▌| 2309/2416 [04:22<02:25,  1.36s/it]Iteration:  96%|█████████▌| 2310/2416 [04:23<02:20,  1.33s/it]Iteration:  96%|█████████▌| 2311/2416 [04:24<02:16,  1.30s/it]Iteration:  96%|█████████▌| 2312/2416 [04:26<02:15,  1.30s/it]Iteration:  96%|█████████▌| 2313/2416 [04:27<02:07,  1.24s/it]Iteration:  96%|█████████▌| 2314/2416 [04:28<02:09,  1.27s/it]Iteration:  96%|█████████▌| 2315/2416 [04:29<02:05,  1.24s/it]Iteration:  96%|█████████▌| 2316/2416 [04:31<02:08,  1.29s/it]Iteration:  96%|█████████▌| 2317/2416 [04:32<02:19,  1.41s/it]Iteration:  96%|█████████▌| 2318/2416 [04:34<02:16,  1.39s/it]Iteration:  96%|█████████▌| 2319/2416 [04:35<02:23,  1.48s/it]Iteration:  96%|█████████▌| 2320/2416 [04:37<02:15,  1.41s/it]Iteration:  96%|█████████▌| 2321/2416 [04:38<02:16,  1.44s/it]Iteration:  96%|█████████▌| 2322/2416 [04:39<02:06,  1.34s/it]Iteration:  96%|█████████▌| 2323/2416 [04:40<01:59,  1.29s/it]Iteration:  96%|█████████▌| 2324/2416 [04:42<01:56,  1.27s/it]Iteration:  96%|█████████▌| 2325/2416 [04:43<02:05,  1.38s/it]Iteration:  96%|█████████▋| 2326/2416 [04:44<01:57,  1.31s/it]Iteration:  96%|█████████▋| 2327/2416 [04:46<01:58,  1.33s/it]Iteration:  96%|█████████▋| 2328/2416 [04:47<01:56,  1.32s/it]Iteration:  96%|█████████▋| 2329/2416 [04:48<01:50,  1.27s/it]Iteration:  96%|█████████▋| 2330/2416 [04:50<02:02,  1.43s/it]Iteration:  96%|█████████▋| 2331/2416 [04:51<01:59,  1.41s/it]Iteration:  97%|█████████▋| 2332/2416 [04:53<01:53,  1.35s/it]Iteration:  97%|█████████▋| 2333/2416 [04:54<02:00,  1.45s/it]Iteration:  97%|█████████▋| 2334/2416 [04:56<01:52,  1.38s/it]Iteration:  97%|█████████▋| 2335/2416 [04:57<01:46,  1.31s/it]Iteration:  97%|█████████▋| 2336/2416 [04:58<01:41,  1.27s/it]Iteration:  97%|█████████▋| 2337/2416 [04:59<01:44,  1.33s/it]Iteration:  97%|█████████▋| 2338/2416 [05:01<01:42,  1.32s/it]Iteration:  97%|█████████▋| 2339/2416 [05:02<01:40,  1.30s/it]Iteration:  97%|█████████▋| 2340/2416 [05:03<01:36,  1.27s/it]Iteration:  97%|█████████▋| 2341/2416 [05:04<01:37,  1.30s/it]Iteration:  97%|█████████▋| 2342/2416 [05:06<01:35,  1.29s/it]Iteration:  97%|█████████▋| 2343/2416 [05:07<01:33,  1.28s/it]Iteration:  97%|█████████▋| 2344/2416 [05:08<01:31,  1.27s/it]Iteration:  97%|█████████▋| 2345/2416 [05:09<01:28,  1.25s/it]Iteration:  97%|█████████▋| 2346/2416 [05:10<01:23,  1.19s/it]Iteration:  97%|█████████▋| 2347/2416 [05:12<01:37,  1.41s/it]Iteration:  97%|█████████▋| 2348/2416 [05:14<01:32,  1.35s/it]Iteration:  97%|█████████▋| 2349/2416 [05:15<01:28,  1.32s/it]Iteration:  97%|█████████▋| 2350/2416 [05:16<01:25,  1.30s/it]Iteration:  97%|█████████▋| 2351/2416 [05:18<01:28,  1.36s/it]Iteration:  97%|█████████▋| 2352/2416 [05:19<01:26,  1.36s/it]Iteration:  97%|█████████▋| 2353/2416 [05:21<01:32,  1.46s/it]Iteration:  97%|█████████▋| 2354/2416 [05:22<01:21,  1.31s/it]Iteration:  97%|█████████▋| 2355/2416 [05:23<01:16,  1.25s/it]Iteration:  98%|█████████▊| 2356/2416 [05:24<01:13,  1.23s/it]Iteration:  98%|█████████▊| 2357/2416 [05:25<01:16,  1.30s/it]Iteration:  98%|█████████▊| 2358/2416 [05:26<01:10,  1.21s/it]Iteration:  98%|█████████▊| 2359/2416 [05:27<01:06,  1.17s/it]Iteration:  98%|█████████▊| 2360/2416 [05:29<01:13,  1.32s/it]Iteration:  98%|█████████▊| 2361/2416 [05:30<01:11,  1.31s/it]Iteration:  98%|█████████▊| 2362/2416 [05:31<01:06,  1.23s/it]Iteration:  98%|█████████▊| 2363/2416 [05:33<01:05,  1.23s/it]Iteration:  98%|█████████▊| 2364/2416 [05:34<01:06,  1.27s/it]Iteration:  98%|█████████▊| 2365/2416 [05:35<01:04,  1.26s/it]Iteration:  98%|█████████▊| 2366/2416 [05:37<01:02,  1.26s/it]Iteration:  98%|█████████▊| 2367/2416 [05:38<01:00,  1.23s/it]Iteration:  98%|█████████▊| 2368/2416 [05:40<01:08,  1.42s/it]Iteration:  98%|█████████▊| 2369/2416 [05:41<01:00,  1.29s/it]Iteration:  98%|█████████▊| 2370/2416 [05:42<01:03,  1.38s/it]Iteration:  98%|█████████▊| 2371/2416 [05:43<01:01,  1.37s/it]Iteration:  98%|█████████▊| 2372/2416 [05:45<01:04,  1.46s/it]Iteration:  98%|█████████▊| 2373/2416 [05:46<01:00,  1.41s/it]Iteration:  98%|█████████▊| 2374/2416 [05:48<01:00,  1.45s/it]Iteration:  98%|█████████▊| 2375/2416 [05:49<00:57,  1.39s/it]Iteration:  98%|█████████▊| 2376/2416 [05:51<00:57,  1.43s/it]Iteration:  98%|█████████▊| 2377/2416 [05:52<00:57,  1.47s/it]Iteration:  98%|█████████▊| 2378/2416 [05:54<00:56,  1.48s/it]Iteration:  98%|█████████▊| 2379/2416 [05:55<00:51,  1.39s/it]Iteration:  99%|█████████▊| 2380/2416 [05:56<00:49,  1.36s/it]Iteration:  99%|█████████▊| 2381/2416 [05:58<00:49,  1.42s/it]Iteration:  99%|█████████▊| 2382/2416 [05:59<00:47,  1.40s/it]Iteration:  99%|█████████▊| 2383/2416 [06:01<00:44,  1.36s/it]Iteration:  99%|█████████▊| 2384/2416 [06:02<00:41,  1.29s/it]Iteration:  99%|█████████▊| 2385/2416 [06:03<00:40,  1.29s/it]Iteration:  99%|█████████▉| 2386/2416 [06:04<00:37,  1.24s/it]Iteration:  99%|█████████▉| 2387/2416 [06:06<00:38,  1.34s/it]Iteration:  99%|█████████▉| 2388/2416 [06:07<00:35,  1.26s/it]Iteration:  99%|█████████▉| 2389/2416 [06:08<00:37,  1.38s/it]Iteration:  99%|█████████▉| 2390/2416 [06:10<00:35,  1.38s/it]Iteration:  99%|█████████▉| 2391/2416 [06:11<00:32,  1.31s/it]Iteration:  99%|█████████▉| 2392/2416 [06:13<00:33,  1.40s/it]Iteration:  99%|█████████▉| 2393/2416 [06:14<00:29,  1.29s/it]Iteration:  99%|█████████▉| 2394/2416 [06:15<00:27,  1.27s/it]Iteration:  99%|█████████▉| 2395/2416 [06:16<00:26,  1.28s/it]Iteration:  99%|█████████▉| 2396/2416 [06:17<00:26,  1.32s/it]Iteration:  99%|█████████▉| 2397/2416 [06:19<00:26,  1.40s/it]Iteration:  99%|█████████▉| 2398/2416 [06:20<00:24,  1.35s/it]Iteration:  99%|█████████▉| 2399/2416 [06:22<00:22,  1.33s/it]Iteration:  99%|█████████▉| 2400/2416 [06:23<00:20,  1.30s/it]Iteration:  99%|█████████▉| 2401/2416 [06:24<00:18,  1.26s/it]Iteration:  99%|█████████▉| 2402/2416 [06:25<00:18,  1.29s/it]Iteration:  99%|█████████▉| 2403/2416 [06:27<00:18,  1.45s/it]Iteration: 100%|█████████▉| 2404/2416 [06:28<00:16,  1.34s/it]Iteration: 100%|█████████▉| 2405/2416 [06:30<00:14,  1.36s/it]Iteration: 100%|█████████▉| 2406/2416 [06:31<00:12,  1.28s/it]Iteration: 100%|█████████▉| 2407/2416 [06:32<00:11,  1.32s/it]Iteration: 100%|█████████▉| 2408/2416 [06:33<00:09,  1.24s/it]Iteration: 100%|█████████▉| 2409/2416 [06:35<00:08,  1.26s/it]Iteration: 100%|█████████▉| 2410/2416 [06:36<00:07,  1.29s/it]Iteration: 100%|█████████▉| 2411/2416 [06:37<00:06,  1.33s/it]Iteration: 100%|█████████▉| 2412/2416 [06:39<00:05,  1.38s/it]Iteration: 100%|█████████▉| 2413/2416 [06:41<00:04,  1.48s/it]Iteration: 100%|█████████▉| 2414/2416 [06:42<00:02,  1.38s/it]Iteration: 100%|█████████▉| 2415/2416 [06:43<00:01,  1.37s/it]Iteration: 100%|██████████| 2416/2416 [06:44<00:00,  1.38s/it]Iteration: 100%|██████████| 2416/2416 [06:44<00:00,  5.97it/s]
