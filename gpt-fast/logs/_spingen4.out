`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 05-19 08:20:34 llm_engine.py:87] Initializing an LLM engine with config: model='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 05-19 08:20:43 llm_engine.py:357] # GPU blocks: 27829, # CPU blocks: 2048
Time to load model: 14.20 seconds
Iteration:   0%|          | 0/2416 [00:00<?, ?it/s]Iteration:  50%|█████     | 1209/2416 [00:01<00:01, 730.29it/s]Iteration:  50%|█████     | 1209/2416 [00:19<00:01, 730.29it/s]Iteration:  51%|█████     | 1224/2416 [00:20<00:28, 42.21it/s] Iteration:  51%|█████     | 1225/2416 [00:22<00:30, 38.91it/s]Iteration:  51%|█████     | 1225/2416 [00:39<00:30, 38.91it/s]Iteration:  51%|█████▏    | 1239/2416 [00:41<01:20, 14.64it/s]Iteration:  51%|█████▏    | 1240/2416 [00:42<01:25, 13.70it/s]Iteration:  51%|█████▏    | 1240/2416 [00:59<01:25, 13.70it/s]Iteration:  52%|█████▏    | 1253/2416 [01:01<02:57,  6.57it/s]Iteration:  52%|█████▏    | 1254/2416 [01:04<03:14,  5.98it/s]Iteration:  52%|█████▏    | 1264/2416 [01:16<04:49,  3.98it/s]Iteration:  52%|█████▏    | 1265/2416 [01:17<05:02,  3.81it/s]Iteration:  53%|█████▎    | 1272/2416 [01:27<07:17,  2.61it/s]Iteration:  53%|█████▎    | 1277/2416 [01:34<09:20,  2.03it/s]Iteration:  53%|█████▎    | 1280/2416 [01:38<10:29,  1.81it/s]Iteration:  53%|█████▎    | 1282/2416 [01:41<11:22,  1.66it/s]Iteration:  53%|█████▎    | 1284/2416 [01:44<12:32,  1.50it/s]Iteration:  53%|█████▎    | 1285/2416 [01:45<13:03,  1.44it/s]Iteration:  53%|█████▎    | 1286/2416 [01:46<14:01,  1.34it/s]Iteration:  53%|█████▎    | 1287/2416 [01:47<15:05,  1.25it/s]Iteration:  53%|█████▎    | 1288/2416 [01:48<15:44,  1.19it/s]Iteration:  53%|█████▎    | 1289/2416 [01:50<17:27,  1.08it/s]Iteration:  53%|█████▎    | 1290/2416 [01:51<19:06,  1.02s/it]Iteration:  53%|█████▎    | 1291/2416 [01:53<20:21,  1.09s/it]Iteration:  53%|█████▎    | 1292/2416 [01:54<22:13,  1.19s/it]Iteration:  54%|█████▎    | 1293/2416 [01:56<22:46,  1.22s/it]Iteration:  54%|█████▎    | 1294/2416 [01:57<22:58,  1.23s/it]Iteration:  54%|█████▎    | 1295/2416 [01:58<23:25,  1.25s/it]Iteration:  54%|█████▎    | 1296/2416 [01:59<23:15,  1.25s/it]Iteration:  54%|█████▎    | 1297/2416 [02:01<23:14,  1.25s/it]Iteration:  54%|█████▎    | 1298/2416 [02:02<25:33,  1.37s/it]Iteration:  54%|█████▍    | 1299/2416 [02:04<25:51,  1.39s/it]Iteration:  54%|█████▍    | 1300/2416 [02:05<26:12,  1.41s/it]Iteration:  54%|█████▍    | 1301/2416 [02:06<24:39,  1.33s/it]Iteration:  54%|█████▍    | 1302/2416 [02:08<24:17,  1.31s/it]Iteration:  54%|█████▍    | 1303/2416 [02:09<24:59,  1.35s/it]Iteration:  54%|█████▍    | 1304/2416 [02:10<25:01,  1.35s/it]Iteration:  54%|█████▍    | 1305/2416 [02:12<25:48,  1.39s/it]Iteration:  54%|█████▍    | 1306/2416 [02:13<23:59,  1.30s/it]Iteration:  54%|█████▍    | 1307/2416 [02:14<25:14,  1.37s/it]Iteration:  54%|█████▍    | 1308/2416 [02:16<25:28,  1.38s/it]Iteration:  54%|█████▍    | 1309/2416 [02:17<24:30,  1.33s/it]Iteration:  54%|█████▍    | 1310/2416 [02:18<24:30,  1.33s/it]Iteration:  54%|█████▍    | 1311/2416 [02:20<25:35,  1.39s/it]Iteration:  54%|█████▍    | 1312/2416 [02:21<25:29,  1.39s/it]Iteration:  54%|█████▍    | 1313/2416 [02:22<24:13,  1.32s/it]Iteration:  54%|█████▍    | 1314/2416 [02:24<24:10,  1.32s/it]Iteration:  54%|█████▍    | 1315/2416 [02:25<25:48,  1.41s/it]Iteration:  54%|█████▍    | 1316/2416 [02:27<25:40,  1.40s/it]Iteration:  55%|█████▍    | 1317/2416 [02:28<25:10,  1.37s/it]Iteration:  55%|█████▍    | 1318/2416 [02:29<23:03,  1.26s/it]Iteration:  55%|█████▍    | 1319/2416 [02:30<23:25,  1.28s/it]Iteration:  55%|█████▍    | 1320/2416 [02:32<23:25,  1.28s/it]Iteration:  55%|█████▍    | 1321/2416 [02:33<23:01,  1.26s/it]Iteration:  55%|█████▍    | 1322/2416 [02:34<24:12,  1.33s/it]Iteration:  55%|█████▍    | 1323/2416 [02:36<25:30,  1.40s/it]Iteration:  55%|█████▍    | 1324/2416 [02:37<24:32,  1.35s/it]Iteration:  55%|█████▍    | 1325/2416 [02:39<24:49,  1.37s/it]Iteration:  55%|█████▍    | 1326/2416 [02:40<23:54,  1.32s/it]Iteration:  55%|█████▍    | 1327/2416 [02:41<22:31,  1.24s/it]Iteration:  55%|█████▍    | 1328/2416 [02:42<22:19,  1.23s/it]Iteration:  55%|█████▌    | 1329/2416 [02:44<23:48,  1.31s/it]Iteration:  55%|█████▌    | 1330/2416 [02:45<24:29,  1.35s/it]Iteration:  55%|█████▌    | 1331/2416 [02:46<24:12,  1.34s/it]Iteration:  55%|█████▌    | 1332/2416 [02:48<23:57,  1.33s/it]Iteration:  55%|█████▌    | 1333/2416 [02:49<23:23,  1.30s/it]Iteration:  55%|█████▌    | 1334/2416 [02:51<26:27,  1.47s/it]Iteration:  55%|█████▌    | 1335/2416 [02:52<25:39,  1.42s/it]Iteration:  55%|█████▌    | 1336/2416 [02:54<26:14,  1.46s/it]Iteration:  55%|█████▌    | 1337/2416 [02:55<24:45,  1.38s/it]Iteration:  55%|█████▌    | 1338/2416 [02:56<23:13,  1.29s/it]Iteration:  55%|█████▌    | 1339/2416 [02:57<23:44,  1.32s/it]Iteration:  55%|█████▌    | 1340/2416 [02:58<22:56,  1.28s/it]Iteration:  56%|█████▌    | 1341/2416 [03:00<24:06,  1.35s/it]Iteration:  56%|█████▌    | 1342/2416 [03:01<23:08,  1.29s/it]Iteration:  56%|█████▌    | 1343/2416 [03:02<22:28,  1.26s/it]Iteration:  56%|█████▌    | 1344/2416 [03:04<23:32,  1.32s/it]Iteration:  56%|█████▌    | 1345/2416 [03:05<25:07,  1.41s/it]Iteration:  56%|█████▌    | 1346/2416 [03:07<26:02,  1.46s/it]Iteration:  56%|█████▌    | 1347/2416 [03:08<25:21,  1.42s/it]Iteration:  56%|█████▌    | 1348/2416 [03:10<24:30,  1.38s/it]Iteration:  56%|█████▌    | 1349/2416 [03:11<24:17,  1.37s/it]Iteration:  56%|█████▌    | 1350/2416 [03:12<23:31,  1.32s/it]Iteration:  56%|█████▌    | 1351/2416 [03:14<24:19,  1.37s/it]Iteration:  56%|█████▌    | 1352/2416 [03:15<24:01,  1.35s/it]Iteration:  56%|█████▌    | 1353/2416 [03:16<23:13,  1.31s/it]Iteration:  56%|█████▌    | 1354/2416 [03:17<23:10,  1.31s/it]Iteration:  56%|█████▌    | 1355/2416 [03:19<22:00,  1.24s/it]Iteration:  56%|█████▌    | 1356/2416 [03:20<23:08,  1.31s/it]Iteration:  56%|█████▌    | 1357/2416 [03:21<24:04,  1.36s/it]Iteration:  56%|█████▌    | 1358/2416 [03:23<23:11,  1.31s/it]Iteration:  56%|█████▋    | 1359/2416 [03:24<23:37,  1.34s/it]Iteration:  56%|█████▋    | 1360/2416 [03:25<23:12,  1.32s/it]Iteration:  56%|█████▋    | 1361/2416 [03:27<23:03,  1.31s/it]Iteration:  56%|█████▋    | 1362/2416 [03:28<22:22,  1.27s/it]Iteration:  56%|█████▋    | 1363/2416 [03:30<25:17,  1.44s/it]Iteration:  56%|█████▋    | 1364/2416 [03:31<24:40,  1.41s/it]Iteration:  56%|█████▋    | 1365/2416 [03:33<26:39,  1.52s/it]Iteration:  57%|█████▋    | 1366/2416 [03:34<25:32,  1.46s/it]Iteration:  57%|█████▋    | 1367/2416 [03:35<23:40,  1.35s/it]Iteration:  57%|█████▋    | 1368/2416 [03:37<26:07,  1.50s/it]Iteration:  57%|█████▋    | 1369/2416 [03:38<25:26,  1.46s/it]Iteration:  57%|█████▋    | 1370/2416 [03:40<25:21,  1.45s/it]Iteration:  57%|█████▋    | 1371/2416 [03:41<23:22,  1.34s/it]Iteration:  57%|█████▋    | 1372/2416 [03:43<26:23,  1.52s/it]Iteration:  57%|█████▋    | 1373/2416 [03:44<25:39,  1.48s/it]Iteration:  57%|█████▋    | 1374/2416 [03:45<24:02,  1.38s/it]Iteration:  57%|█████▋    | 1375/2416 [03:47<23:42,  1.37s/it]Iteration:  57%|█████▋    | 1376/2416 [03:48<25:49,  1.49s/it]Iteration:  57%|█████▋    | 1377/2416 [03:50<23:25,  1.35s/it]Iteration:  57%|█████▋    | 1378/2416 [03:51<23:40,  1.37s/it]Iteration:  57%|█████▋    | 1379/2416 [03:52<23:44,  1.37s/it]Iteration:  57%|█████▋    | 1380/2416 [03:54<23:45,  1.38s/it]Iteration:  57%|█████▋    | 1381/2416 [03:55<22:46,  1.32s/it]Iteration:  57%|█████▋    | 1382/2416 [03:56<22:22,  1.30s/it]Iteration:  57%|█████▋    | 1383/2416 [03:57<22:40,  1.32s/it]Iteration:  57%|█████▋    | 1384/2416 [03:59<23:14,  1.35s/it]Iteration:  57%|█████▋    | 1385/2416 [04:00<23:21,  1.36s/it]Iteration:  57%|█████▋    | 1386/2416 [04:01<22:30,  1.31s/it]Iteration:  57%|█████▋    | 1387/2416 [04:03<21:50,  1.27s/it]Iteration:  57%|█████▋    | 1388/2416 [04:04<22:15,  1.30s/it]Iteration:  57%|█████▋    | 1389/2416 [04:05<21:55,  1.28s/it]Iteration:  58%|█████▊    | 1390/2416 [04:07<22:37,  1.32s/it]Iteration:  58%|█████▊    | 1391/2416 [04:08<21:57,  1.28s/it]Iteration:  58%|█████▊    | 1392/2416 [04:09<22:32,  1.32s/it]Iteration:  58%|█████▊    | 1393/2416 [04:10<21:45,  1.28s/it]Iteration:  58%|█████▊    | 1394/2416 [04:12<21:13,  1.25s/it]Iteration:  58%|█████▊    | 1395/2416 [04:13<23:07,  1.36s/it]Iteration:  58%|█████▊    | 1396/2416 [04:14<22:01,  1.30s/it]Iteration:  58%|█████▊    | 1397/2416 [04:16<22:16,  1.31s/it]Iteration:  58%|█████▊    | 1398/2416 [04:17<22:09,  1.31s/it]Iteration:  58%|█████▊    | 1399/2416 [04:18<21:23,  1.26s/it]Iteration:  58%|█████▊    | 1400/2416 [04:20<23:53,  1.41s/it]Iteration:  58%|█████▊    | 1401/2416 [04:21<24:15,  1.43s/it]Iteration:  58%|█████▊    | 1402/2416 [04:23<24:14,  1.43s/it]Iteration:  58%|█████▊    | 1403/2416 [04:24<24:19,  1.44s/it]Iteration:  58%|█████▊    | 1404/2416 [04:26<24:33,  1.46s/it]Iteration:  58%|█████▊    | 1405/2416 [04:27<22:25,  1.33s/it]Iteration:  58%|█████▊    | 1406/2416 [04:29<25:18,  1.50s/it]Iteration:  58%|█████▊    | 1407/2416 [04:30<23:48,  1.42s/it]Iteration:  58%|█████▊    | 1408/2416 [04:31<22:27,  1.34s/it]Iteration:  58%|█████▊    | 1409/2416 [04:32<21:12,  1.26s/it]Iteration:  58%|█████▊    | 1410/2416 [04:34<22:23,  1.34s/it]Iteration:  58%|█████▊    | 1411/2416 [04:35<21:39,  1.29s/it]Iteration:  58%|█████▊    | 1412/2416 [04:36<22:48,  1.36s/it]Iteration:  58%|█████▊    | 1413/2416 [04:38<23:17,  1.39s/it]Iteration:  59%|█████▊    | 1414/2416 [04:39<23:08,  1.39s/it]Iteration:  59%|█████▊    | 1415/2416 [04:40<22:11,  1.33s/it]Iteration:  59%|█████▊    | 1416/2416 [04:42<21:47,  1.31s/it]Iteration:  59%|█████▊    | 1417/2416 [04:43<21:34,  1.30s/it]Iteration:  59%|█████▊    | 1418/2416 [04:44<21:59,  1.32s/it]Iteration:  59%|█████▊    | 1419/2416 [04:46<21:32,  1.30s/it]Iteration:  59%|█████▉    | 1420/2416 [04:47<20:33,  1.24s/it]Iteration:  59%|█████▉    | 1421/2416 [04:48<20:53,  1.26s/it]Iteration:  59%|█████▉    | 1422/2416 [04:49<20:56,  1.26s/it]Iteration:  59%|█████▉    | 1423/2416 [04:51<20:43,  1.25s/it]Iteration:  59%|█████▉    | 1424/2416 [04:52<20:08,  1.22s/it]Iteration:  59%|█████▉    | 1425/2416 [04:53<20:54,  1.27s/it]Iteration:  59%|█████▉    | 1426/2416 [04:54<21:23,  1.30s/it]Iteration:  59%|█████▉    | 1427/2416 [04:56<21:19,  1.29s/it]Iteration:  59%|█████▉    | 1428/2416 [04:57<20:54,  1.27s/it]Iteration:  59%|█████▉    | 1429/2416 [04:58<22:01,  1.34s/it]Iteration:  59%|█████▉    | 1430/2416 [05:00<21:30,  1.31s/it]Iteration:  59%|█████▉    | 1431/2416 [05:01<22:07,  1.35s/it]Iteration:  59%|█████▉    | 1432/2416 [05:03<22:36,  1.38s/it]Iteration:  59%|█████▉    | 1433/2416 [05:04<22:53,  1.40s/it]Iteration:  59%|█████▉    | 1434/2416 [05:05<22:00,  1.34s/it]Iteration:  59%|█████▉    | 1435/2416 [05:06<20:37,  1.26s/it]Iteration:  59%|█████▉    | 1436/2416 [05:08<21:34,  1.32s/it]Iteration:  59%|█████▉    | 1437/2416 [05:09<21:38,  1.33s/it]Iteration:  60%|█████▉    | 1438/2416 [05:10<21:46,  1.34s/it]Iteration:  60%|█████▉    | 1439/2416 [05:12<21:49,  1.34s/it]Iteration:  60%|█████▉    | 1440/2416 [05:13<22:07,  1.36s/it]Iteration:  60%|█████▉    | 1441/2416 [05:15<26:16,  1.62s/it]Iteration:  60%|█████▉    | 1442/2416 [05:17<24:35,  1.52s/it]Iteration:  60%|█████▉    | 1443/2416 [05:18<23:54,  1.47s/it]Iteration:  60%|█████▉    | 1444/2416 [05:20<23:39,  1.46s/it]Iteration:  60%|█████▉    | 1445/2416 [05:21<25:21,  1.57s/it]Iteration:  60%|█████▉    | 1446/2416 [05:22<22:42,  1.40s/it]Iteration:  60%|█████▉    | 1447/2416 [05:24<23:14,  1.44s/it]Iteration:  60%|█████▉    | 1448/2416 [05:25<21:50,  1.35s/it]Iteration:  60%|█████▉    | 1449/2416 [05:26<21:05,  1.31s/it]Iteration:  60%|██████    | 1450/2416 [05:27<20:25,  1.27s/it]Iteration:  60%|██████    | 1451/2416 [05:30<24:51,  1.55s/it]Iteration:  60%|██████    | 1452/2416 [05:31<23:56,  1.49s/it]Iteration:  60%|██████    | 1453/2416 [05:32<21:52,  1.36s/it]Iteration:  60%|██████    | 1454/2416 [05:34<23:56,  1.49s/it]Iteration:  60%|██████    | 1455/2416 [05:35<24:01,  1.50s/it]Iteration:  60%|██████    | 1456/2416 [05:37<22:48,  1.43s/it]Iteration:  60%|██████    | 1457/2416 [05:38<22:40,  1.42s/it]Iteration:  60%|██████    | 1458/2416 [05:39<21:39,  1.36s/it]Iteration:  60%|██████    | 1459/2416 [05:40<20:04,  1.26s/it]Iteration:  60%|██████    | 1460/2416 [05:42<20:12,  1.27s/it]Iteration:  60%|██████    | 1461/2416 [05:43<19:49,  1.25s/it]Iteration:  61%|██████    | 1462/2416 [05:44<19:54,  1.25s/it]Iteration:  61%|██████    | 1463/2416 [05:45<19:57,  1.26s/it]Iteration:  61%|██████    | 1464/2416 [05:47<20:17,  1.28s/it]Iteration:  61%|██████    | 1465/2416 [05:48<21:03,  1.33s/it]Iteration:  61%|██████    | 1466/2416 [05:49<20:58,  1.32s/it]Iteration:  61%|██████    | 1467/2416 [05:51<20:19,  1.29s/it]Iteration:  61%|██████    | 1468/2416 [05:52<20:21,  1.29s/it]Iteration:  61%|██████    | 1469/2416 [05:53<20:19,  1.29s/it]Iteration:  61%|██████    | 1470/2416 [05:54<20:24,  1.29s/it]Iteration:  61%|██████    | 1471/2416 [05:56<20:36,  1.31s/it]Iteration:  61%|██████    | 1472/2416 [05:57<20:21,  1.29s/it]Iteration:  61%|██████    | 1473/2416 [05:59<21:28,  1.37s/it]Iteration:  61%|██████    | 1474/2416 [06:00<19:38,  1.25s/it]Iteration:  61%|██████    | 1475/2416 [06:01<21:12,  1.35s/it]Iteration:  61%|██████    | 1476/2416 [06:02<19:34,  1.25s/it]Iteration:  61%|██████    | 1477/2416 [06:03<19:42,  1.26s/it]Iteration:  61%|██████    | 1478/2416 [06:05<20:27,  1.31s/it]Iteration:  61%|██████    | 1479/2416 [06:06<19:16,  1.23s/it]Iteration:  61%|██████▏   | 1480/2416 [06:07<19:57,  1.28s/it]Iteration:  61%|██████▏   | 1481/2416 [06:08<19:34,  1.26s/it]Iteration:  61%|██████▏   | 1482/2416 [06:10<20:26,  1.31s/it]Iteration:  61%|██████▏   | 1483/2416 [06:11<19:52,  1.28s/it]Iteration:  61%|██████▏   | 1484/2416 [06:12<19:43,  1.27s/it]Iteration:  61%|██████▏   | 1485/2416 [06:14<20:02,  1.29s/it]Iteration:  62%|██████▏   | 1486/2416 [06:15<20:11,  1.30s/it]Iteration:  62%|██████▏   | 1487/2416 [06:16<20:23,  1.32s/it]Iteration:  62%|██████▏   | 1488/2416 [06:18<20:21,  1.32s/it]Iteration:  62%|██████▏   | 1489/2416 [06:19<21:14,  1.37s/it]Iteration:  62%|██████▏   | 1490/2416 [06:20<19:36,  1.27s/it]Iteration:  62%|██████▏   | 1491/2416 [06:21<19:14,  1.25s/it]Iteration:  62%|██████▏   | 1492/2416 [06:23<21:50,  1.42s/it]Iteration:  62%|██████▏   | 1493/2416 [06:25<21:32,  1.40s/it]Iteration:  62%|██████▏   | 1494/2416 [06:26<20:10,  1.31s/it]Iteration:  62%|██████▏   | 1495/2416 [06:27<20:02,  1.31s/it]Iteration:  62%|██████▏   | 1496/2416 [06:28<20:02,  1.31s/it]Iteration:  62%|██████▏   | 1497/2416 [06:30<21:23,  1.40s/it]Iteration:  62%|██████▏   | 1498/2416 [06:31<21:02,  1.38s/it]Iteration:  62%|██████▏   | 1499/2416 [06:33<20:58,  1.37s/it]Iteration:  62%|██████▏   | 1500/2416 [06:34<21:15,  1.39s/it]Iteration:  62%|██████▏   | 1501/2416 [06:35<19:53,  1.30s/it]Iteration:  62%|██████▏   | 1502/2416 [06:36<19:27,  1.28s/it]Iteration:  62%|██████▏   | 1503/2416 [06:38<19:33,  1.29s/it]Iteration:  62%|██████▏   | 1504/2416 [06:39<20:49,  1.37s/it]Iteration:  62%|██████▏   | 1505/2416 [06:41<21:38,  1.43s/it]Iteration:  62%|██████▏   | 1506/2416 [06:42<20:23,  1.34s/it]Iteration:  62%|██████▏   | 1507/2416 [06:43<19:33,  1.29s/it]Iteration:  62%|██████▏   | 1508/2416 [06:45<20:24,  1.35s/it]Iteration:  62%|██████▏   | 1509/2416 [06:46<21:15,  1.41s/it]Iteration:  62%|██████▎   | 1510/2416 [06:47<19:50,  1.31s/it]Iteration:  62%|██████▎   | 1510/2416 [06:47<04:04,  3.70it/s]
