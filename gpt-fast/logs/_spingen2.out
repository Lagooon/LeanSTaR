`apex` is not installed. Reverting to non-fused RMSNorm.
Loading model ...
INFO 05-19 08:20:34 llm_engine.py:87] Initializing an LLM engine with config: model='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer='/nobackup/users/zhiqings/haohanl/Lean/checkpoints/internlm/internlm2-math-base-7b/star', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 05-19 08:20:43 llm_engine.py:357] # GPU blocks: 27829, # CPU blocks: 2048
Time to load model: 14.87 seconds
Iteration:   0%|          | 0/2416 [00:00<?, ?it/s]Iteration:  25%|██▌       | 605/2416 [00:01<00:03, 475.18it/s]Iteration:  25%|██▌       | 605/2416 [00:19<00:03, 475.18it/s]Iteration:  26%|██▌       | 620/2416 [00:20<01:22, 21.79it/s] Iteration:  26%|██▌       | 621/2416 [00:21<01:28, 20.23it/s]Iteration:  26%|██▌       | 621/2416 [00:39<01:28, 20.23it/s]Iteration:  26%|██▋       | 635/2416 [00:40<03:52,  7.67it/s]Iteration:  26%|██▋       | 636/2416 [00:42<04:05,  7.25it/s]Iteration:  27%|██▋       | 647/2416 [00:57<07:22,  4.00it/s]Iteration:  27%|██▋       | 648/2416 [00:59<07:44,  3.81it/s]Iteration:  27%|██▋       | 655/2416 [01:08<11:04,  2.65it/s]Iteration:  27%|██▋       | 660/2416 [01:15<13:58,  2.09it/s]Iteration:  27%|██▋       | 663/2416 [01:20<15:58,  1.83it/s]Iteration:  28%|██▊       | 665/2416 [01:22<17:19,  1.68it/s]Iteration:  28%|██▊       | 667/2416 [01:25<19:49,  1.47it/s]Iteration:  28%|██▊       | 668/2416 [01:27<20:54,  1.39it/s]Iteration:  28%|██▊       | 669/2416 [01:29<23:53,  1.22it/s]Iteration:  28%|██▊       | 670/2416 [01:30<24:40,  1.18it/s]Iteration:  28%|██▊       | 671/2416 [01:31<26:38,  1.09it/s]Iteration:  28%|██▊       | 672/2416 [01:32<27:01,  1.08it/s]Iteration:  28%|██▊       | 673/2416 [01:34<29:16,  1.01s/it]Iteration:  28%|██▊       | 674/2416 [01:35<31:13,  1.08s/it]Iteration:  28%|██▊       | 675/2416 [01:37<34:24,  1.19s/it]Iteration:  28%|██▊       | 676/2416 [01:38<34:01,  1.17s/it]Iteration:  28%|██▊       | 677/2416 [01:39<36:50,  1.27s/it]Iteration:  28%|██▊       | 678/2416 [01:40<36:06,  1.25s/it]Iteration:  28%|██▊       | 679/2416 [01:42<36:34,  1.26s/it]Iteration:  28%|██▊       | 680/2416 [01:43<38:13,  1.32s/it]Iteration:  28%|██▊       | 681/2416 [01:44<37:02,  1.28s/it]Iteration:  28%|██▊       | 682/2416 [01:46<40:13,  1.39s/it]Iteration:  28%|██▊       | 683/2416 [01:47<38:29,  1.33s/it]Iteration:  28%|██▊       | 684/2416 [01:48<37:42,  1.31s/it]Iteration:  28%|██▊       | 685/2416 [01:50<40:52,  1.42s/it]Iteration:  28%|██▊       | 686/2416 [01:51<40:31,  1.41s/it]Iteration:  28%|██▊       | 687/2416 [01:53<41:30,  1.44s/it]Iteration:  28%|██▊       | 688/2416 [01:54<41:10,  1.43s/it]Iteration:  29%|██▊       | 689/2416 [01:56<38:40,  1.34s/it]Iteration:  29%|██▊       | 690/2416 [01:57<39:26,  1.37s/it]Iteration:  29%|██▊       | 691/2416 [01:59<40:54,  1.42s/it]Iteration:  29%|██▊       | 692/2416 [02:00<42:20,  1.47s/it]Iteration:  29%|██▊       | 693/2416 [02:01<40:18,  1.40s/it]Iteration:  29%|██▊       | 694/2416 [02:03<38:54,  1.36s/it]Iteration:  29%|██▉       | 695/2416 [02:04<39:41,  1.38s/it]Iteration:  29%|██▉       | 696/2416 [02:05<39:47,  1.39s/it]Iteration:  29%|██▉       | 697/2416 [02:07<42:30,  1.48s/it]Iteration:  29%|██▉       | 698/2416 [02:09<42:58,  1.50s/it]Iteration:  29%|██▉       | 699/2416 [02:10<40:54,  1.43s/it]Iteration:  29%|██▉       | 700/2416 [02:11<41:12,  1.44s/it]Iteration:  29%|██▉       | 701/2416 [02:13<38:26,  1.34s/it]Iteration:  29%|██▉       | 702/2416 [02:14<38:41,  1.35s/it]Iteration:  29%|██▉       | 703/2416 [02:15<38:03,  1.33s/it]Iteration:  29%|██▉       | 704/2416 [02:16<36:47,  1.29s/it]Iteration:  29%|██▉       | 705/2416 [02:18<36:19,  1.27s/it]Iteration:  29%|██▉       | 706/2416 [02:19<37:24,  1.31s/it]Iteration:  29%|██▉       | 707/2416 [02:20<36:12,  1.27s/it]Iteration:  29%|██▉       | 708/2416 [02:22<36:19,  1.28s/it]Iteration:  29%|██▉       | 709/2416 [02:23<36:50,  1.29s/it]Iteration:  29%|██▉       | 710/2416 [02:24<39:03,  1.37s/it]Iteration:  29%|██▉       | 711/2416 [02:26<41:26,  1.46s/it]Iteration:  29%|██▉       | 712/2416 [02:27<40:05,  1.41s/it]Iteration:  30%|██▉       | 713/2416 [02:30<46:38,  1.64s/it]Iteration:  30%|██▉       | 714/2416 [02:31<43:27,  1.53s/it]Iteration:  30%|██▉       | 715/2416 [02:32<41:17,  1.46s/it]Iteration:  30%|██▉       | 716/2416 [02:33<40:33,  1.43s/it]Iteration:  30%|██▉       | 717/2416 [02:35<39:22,  1.39s/it]Iteration:  30%|██▉       | 718/2416 [02:36<36:33,  1.29s/it]Iteration:  30%|██▉       | 719/2416 [02:37<37:50,  1.34s/it]Iteration:  30%|██▉       | 720/2416 [02:38<35:35,  1.26s/it]Iteration:  30%|██▉       | 721/2416 [02:40<35:16,  1.25s/it]Iteration:  30%|██▉       | 722/2416 [02:42<42:24,  1.50s/it]Iteration:  30%|██▉       | 723/2416 [02:43<44:40,  1.58s/it]Iteration:  30%|██▉       | 724/2416 [02:45<42:26,  1.50s/it]Iteration:  30%|███       | 725/2416 [02:46<41:40,  1.48s/it]Iteration:  30%|███       | 726/2416 [02:47<38:03,  1.35s/it]Iteration:  30%|███       | 727/2416 [02:49<41:25,  1.47s/it]Iteration:  30%|███       | 728/2416 [02:50<39:43,  1.41s/it]Iteration:  30%|███       | 729/2416 [02:52<40:22,  1.44s/it]Iteration:  30%|███       | 730/2416 [02:53<37:48,  1.35s/it]Iteration:  30%|███       | 731/2416 [02:54<36:25,  1.30s/it]Iteration:  30%|███       | 732/2416 [02:56<40:44,  1.45s/it]Iteration:  30%|███       | 733/2416 [02:57<38:46,  1.38s/it]Iteration:  30%|███       | 734/2416 [02:59<39:41,  1.42s/it]Iteration:  30%|███       | 735/2416 [03:00<38:41,  1.38s/it]Iteration:  30%|███       | 736/2416 [03:01<36:42,  1.31s/it]Iteration:  31%|███       | 737/2416 [03:02<36:56,  1.32s/it]Iteration:  31%|███       | 738/2416 [03:04<35:12,  1.26s/it]Iteration:  31%|███       | 739/2416 [03:05<33:22,  1.19s/it]Iteration:  31%|███       | 740/2416 [03:06<32:56,  1.18s/it]Iteration:  31%|███       | 741/2416 [03:07<32:58,  1.18s/it]Iteration:  31%|███       | 742/2416 [03:09<36:57,  1.32s/it]Iteration:  31%|███       | 743/2416 [03:10<36:42,  1.32s/it]Iteration:  31%|███       | 744/2416 [03:11<34:34,  1.24s/it]Iteration:  31%|███       | 745/2416 [03:12<33:14,  1.19s/it]Iteration:  31%|███       | 746/2416 [03:13<34:11,  1.23s/it]Iteration:  31%|███       | 747/2416 [03:14<33:18,  1.20s/it]Iteration:  31%|███       | 748/2416 [03:16<34:23,  1.24s/it]Iteration:  31%|███       | 749/2416 [03:17<37:03,  1.33s/it]Iteration:  31%|███       | 750/2416 [03:19<36:52,  1.33s/it]Iteration:  31%|███       | 751/2416 [03:20<37:16,  1.34s/it]Iteration:  31%|███       | 752/2416 [03:21<35:28,  1.28s/it]Iteration:  31%|███       | 753/2416 [03:23<36:52,  1.33s/it]Iteration:  31%|███       | 754/2416 [03:24<36:07,  1.30s/it]Iteration:  31%|███▏      | 755/2416 [03:25<39:05,  1.41s/it]Iteration:  31%|███▏      | 756/2416 [03:27<38:08,  1.38s/it]Iteration:  31%|███▏      | 757/2416 [03:28<37:39,  1.36s/it]Iteration:  31%|███▏      | 758/2416 [03:29<36:13,  1.31s/it]Iteration:  31%|███▏      | 759/2416 [03:31<36:27,  1.32s/it]Iteration:  31%|███▏      | 760/2416 [03:32<35:51,  1.30s/it]Iteration:  31%|███▏      | 761/2416 [03:34<41:11,  1.49s/it]Iteration:  32%|███▏      | 762/2416 [03:35<39:39,  1.44s/it]Iteration:  32%|███▏      | 763/2416 [03:37<40:29,  1.47s/it]Iteration:  32%|███▏      | 764/2416 [03:38<38:22,  1.39s/it]Iteration:  32%|███▏      | 765/2416 [03:39<36:24,  1.32s/it]Iteration:  32%|███▏      | 766/2416 [03:41<38:24,  1.40s/it]Iteration:  32%|███▏      | 767/2416 [03:42<38:21,  1.40s/it]Iteration:  32%|███▏      | 768/2416 [03:43<38:21,  1.40s/it]Iteration:  32%|███▏      | 769/2416 [03:45<36:30,  1.33s/it]Iteration:  32%|███▏      | 770/2416 [03:46<35:23,  1.29s/it]Iteration:  32%|███▏      | 771/2416 [03:47<34:19,  1.25s/it]Iteration:  32%|███▏      | 772/2416 [03:48<33:14,  1.21s/it]Iteration:  32%|███▏      | 773/2416 [03:50<36:01,  1.32s/it]Iteration:  32%|███▏      | 774/2416 [03:52<40:40,  1.49s/it]Iteration:  32%|███▏      | 775/2416 [03:53<38:21,  1.40s/it]Iteration:  32%|███▏      | 776/2416 [03:54<36:02,  1.32s/it]Iteration:  32%|███▏      | 777/2416 [03:55<36:49,  1.35s/it]Iteration:  32%|███▏      | 778/2416 [03:57<37:35,  1.38s/it]Iteration:  32%|███▏      | 779/2416 [03:58<37:51,  1.39s/it]Iteration:  32%|███▏      | 780/2416 [03:59<34:39,  1.27s/it]Iteration:  32%|███▏      | 781/2416 [04:00<35:11,  1.29s/it]Iteration:  32%|███▏      | 782/2416 [04:03<41:21,  1.52s/it]Iteration:  32%|███▏      | 783/2416 [04:04<39:28,  1.45s/it]Iteration:  32%|███▏      | 784/2416 [04:05<37:16,  1.37s/it]Iteration:  32%|███▏      | 785/2416 [04:06<37:00,  1.36s/it]Iteration:  33%|███▎      | 786/2416 [04:07<35:21,  1.30s/it]Iteration:  33%|███▎      | 787/2416 [04:09<33:32,  1.24s/it]Iteration:  33%|███▎      | 788/2416 [04:10<35:08,  1.29s/it]Iteration:  33%|███▎      | 789/2416 [04:11<35:17,  1.30s/it]Iteration:  33%|███▎      | 790/2416 [04:13<34:44,  1.28s/it]Iteration:  33%|███▎      | 791/2416 [04:14<38:20,  1.42s/it]Iteration:  33%|███▎      | 792/2416 [04:16<40:17,  1.49s/it]Iteration:  33%|███▎      | 793/2416 [04:17<38:12,  1.41s/it]Iteration:  33%|███▎      | 794/2416 [04:18<36:22,  1.35s/it]Iteration:  33%|███▎      | 795/2416 [04:20<37:10,  1.38s/it]Iteration:  33%|███▎      | 796/2416 [04:21<35:24,  1.31s/it]Iteration:  33%|███▎      | 797/2416 [04:23<37:17,  1.38s/it]Iteration:  33%|███▎      | 798/2416 [04:24<34:22,  1.27s/it]Iteration:  33%|███▎      | 799/2416 [04:25<33:36,  1.25s/it]Iteration:  33%|███▎      | 800/2416 [04:26<33:30,  1.24s/it]Iteration:  33%|███▎      | 801/2416 [04:27<34:06,  1.27s/it]Iteration:  33%|███▎      | 802/2416 [04:29<36:50,  1.37s/it]Iteration:  33%|███▎      | 803/2416 [04:30<33:47,  1.26s/it]Iteration:  33%|███▎      | 804/2416 [04:31<35:07,  1.31s/it]Iteration:  33%|███▎      | 805/2416 [04:33<34:11,  1.27s/it]Iteration:  33%|███▎      | 806/2416 [04:34<33:01,  1.23s/it]Iteration:  33%|███▎      | 807/2416 [04:35<34:06,  1.27s/it]Iteration:  33%|███▎      | 808/2416 [04:36<34:18,  1.28s/it]Iteration:  33%|███▎      | 809/2416 [04:37<32:41,  1.22s/it]Iteration:  34%|███▎      | 810/2416 [04:39<32:45,  1.22s/it]Iteration:  34%|███▎      | 811/2416 [04:40<32:48,  1.23s/it]Iteration:  34%|███▎      | 812/2416 [04:42<39:27,  1.48s/it]Iteration:  34%|███▎      | 813/2416 [04:43<38:01,  1.42s/it]Iteration:  34%|███▎      | 814/2416 [04:44<35:49,  1.34s/it]Iteration:  34%|███▎      | 815/2416 [04:46<34:12,  1.28s/it]Iteration:  34%|███▍      | 816/2416 [04:47<34:31,  1.29s/it]Iteration:  34%|███▍      | 817/2416 [04:48<33:22,  1.25s/it]Iteration:  34%|███▍      | 818/2416 [04:49<34:49,  1.31s/it]Iteration:  34%|███▍      | 819/2416 [04:51<34:53,  1.31s/it]Iteration:  34%|███▍      | 820/2416 [04:52<35:13,  1.32s/it]Iteration:  34%|███▍      | 821/2416 [04:53<35:29,  1.33s/it]Iteration:  34%|███▍      | 822/2416 [04:55<40:07,  1.51s/it]Iteration:  34%|███▍      | 823/2416 [04:57<37:39,  1.42s/it]Iteration:  34%|███▍      | 824/2416 [04:58<35:10,  1.33s/it]Iteration:  34%|███▍      | 825/2416 [04:59<35:41,  1.35s/it]Iteration:  34%|███▍      | 826/2416 [05:01<36:16,  1.37s/it]Iteration:  34%|███▍      | 827/2416 [05:02<34:20,  1.30s/it]Iteration:  34%|███▍      | 828/2416 [05:03<35:17,  1.33s/it]Iteration:  34%|███▍      | 829/2416 [05:04<35:34,  1.34s/it]Iteration:  34%|███▍      | 830/2416 [05:06<35:33,  1.34s/it]Iteration:  34%|███▍      | 831/2416 [05:07<36:07,  1.37s/it]Iteration:  34%|███▍      | 832/2416 [05:08<34:57,  1.32s/it]Iteration:  34%|███▍      | 833/2416 [05:10<34:42,  1.32s/it]Iteration:  35%|███▍      | 834/2416 [05:11<32:49,  1.25s/it]Iteration:  35%|███▍      | 835/2416 [05:12<35:24,  1.34s/it]Iteration:  35%|███▍      | 836/2416 [05:14<34:35,  1.31s/it]Iteration:  35%|███▍      | 837/2416 [05:15<34:53,  1.33s/it]Iteration:  35%|███▍      | 838/2416 [05:16<33:54,  1.29s/it]Iteration:  35%|███▍      | 839/2416 [05:18<39:51,  1.52s/it]Iteration:  35%|███▍      | 840/2416 [05:20<38:22,  1.46s/it]Iteration:  35%|███▍      | 841/2416 [05:21<37:04,  1.41s/it]Iteration:  35%|███▍      | 842/2416 [05:23<39:49,  1.52s/it]Iteration:  35%|███▍      | 843/2416 [05:24<38:11,  1.46s/it]Iteration:  35%|███▍      | 844/2416 [05:25<35:59,  1.37s/it]Iteration:  35%|███▍      | 845/2416 [05:27<36:18,  1.39s/it]Iteration:  35%|███▌      | 846/2416 [05:28<35:12,  1.35s/it]Iteration:  35%|███▌      | 847/2416 [05:29<35:16,  1.35s/it]Iteration:  35%|███▌      | 848/2416 [05:31<37:58,  1.45s/it]Iteration:  35%|███▌      | 849/2416 [05:32<37:15,  1.43s/it]Iteration:  35%|███▌      | 850/2416 [05:34<39:55,  1.53s/it]Iteration:  35%|███▌      | 851/2416 [05:35<37:15,  1.43s/it]Iteration:  35%|███▌      | 852/2416 [05:36<33:25,  1.28s/it]Iteration:  35%|███▌      | 853/2416 [05:37<33:52,  1.30s/it]Iteration:  35%|███▌      | 854/2416 [05:39<35:27,  1.36s/it]Iteration:  35%|███▌      | 855/2416 [05:40<34:11,  1.31s/it]Iteration:  35%|███▌      | 856/2416 [05:41<32:07,  1.24s/it]Iteration:  35%|███▌      | 857/2416 [05:42<31:31,  1.21s/it]Iteration:  36%|███▌      | 858/2416 [05:44<34:11,  1.32s/it]Iteration:  36%|███▌      | 859/2416 [05:45<34:11,  1.32s/it]Iteration:  36%|███▌      | 860/2416 [05:46<33:10,  1.28s/it]Iteration:  36%|███▌      | 861/2416 [05:48<33:13,  1.28s/it]Iteration:  36%|███▌      | 862/2416 [05:49<33:28,  1.29s/it]Iteration:  36%|███▌      | 863/2416 [05:50<33:52,  1.31s/it]Iteration:  36%|███▌      | 864/2416 [05:52<34:54,  1.35s/it]Iteration:  36%|███▌      | 865/2416 [05:53<33:47,  1.31s/it]Iteration:  36%|███▌      | 866/2416 [05:54<34:45,  1.35s/it]Iteration:  36%|███▌      | 867/2416 [05:56<33:37,  1.30s/it]Iteration:  36%|███▌      | 868/2416 [05:57<33:09,  1.29s/it]Iteration:  36%|███▌      | 869/2416 [05:58<32:30,  1.26s/it]Iteration:  36%|███▌      | 870/2416 [06:00<33:50,  1.31s/it]Iteration:  36%|███▌      | 871/2416 [06:01<34:34,  1.34s/it]Iteration:  36%|███▌      | 872/2416 [06:02<34:07,  1.33s/it]Iteration:  36%|███▌      | 873/2416 [06:03<32:46,  1.27s/it]Iteration:  36%|███▌      | 874/2416 [06:05<32:30,  1.26s/it]Iteration:  36%|███▌      | 875/2416 [06:06<33:10,  1.29s/it]Iteration:  36%|███▋      | 876/2416 [06:07<32:03,  1.25s/it]Iteration:  36%|███▋      | 877/2416 [06:08<32:41,  1.27s/it]Iteration:  36%|███▋      | 878/2416 [06:10<35:26,  1.38s/it]Iteration:  36%|███▋      | 879/2416 [06:12<36:13,  1.41s/it]Iteration:  36%|███▋      | 880/2416 [06:13<34:54,  1.36s/it]Iteration:  36%|███▋      | 881/2416 [06:14<33:15,  1.30s/it]Iteration:  37%|███▋      | 882/2416 [06:15<33:23,  1.31s/it]Iteration:  37%|███▋      | 883/2416 [06:17<33:36,  1.32s/it]Iteration:  37%|███▋      | 884/2416 [06:18<34:39,  1.36s/it]Iteration:  37%|███▋      | 885/2416 [06:19<33:30,  1.31s/it]Iteration:  37%|███▋      | 886/2416 [06:21<36:24,  1.43s/it]Iteration:  37%|███▋      | 887/2416 [06:22<33:39,  1.32s/it]Iteration:  37%|███▋      | 888/2416 [06:24<34:27,  1.35s/it]Iteration:  37%|███▋      | 889/2416 [06:25<34:19,  1.35s/it]Iteration:  37%|███▋      | 890/2416 [06:26<36:00,  1.42s/it]Iteration:  37%|███▋      | 891/2416 [06:28<34:12,  1.35s/it]Iteration:  37%|███▋      | 892/2416 [06:29<35:32,  1.40s/it]Iteration:  37%|███▋      | 893/2416 [06:30<33:27,  1.32s/it]Iteration:  37%|███▋      | 894/2416 [06:32<33:51,  1.33s/it]Iteration:  37%|███▋      | 895/2416 [06:33<33:10,  1.31s/it]Iteration:  37%|███▋      | 896/2416 [06:34<31:54,  1.26s/it]Iteration:  37%|███▋      | 897/2416 [06:36<34:25,  1.36s/it]Iteration:  37%|███▋      | 898/2416 [06:37<32:07,  1.27s/it]Iteration:  37%|███▋      | 899/2416 [06:38<32:10,  1.27s/it]Iteration:  37%|███▋      | 900/2416 [06:39<30:39,  1.21s/it]Iteration:  37%|███▋      | 901/2416 [06:40<32:11,  1.28s/it]Iteration:  37%|███▋      | 902/2416 [06:42<32:26,  1.29s/it]Iteration:  37%|███▋      | 903/2416 [06:43<34:00,  1.35s/it]Iteration:  37%|███▋      | 904/2416 [06:44<31:07,  1.24s/it]Iteration:  37%|███▋      | 905/2416 [06:45<30:26,  1.21s/it]Iteration:  38%|███▊      | 906/2416 [06:47<31:17,  1.24s/it]Iteration:  38%|███▊      | 906/2416 [06:47<11:18,  2.22it/s]
